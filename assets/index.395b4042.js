const qi=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}};qi();function ht(n){return new ReadableStream({start:n})}const ni={configurable:!1,enumerable:!1,writable:!1};globalThis.FAST===void 0&&Reflect.defineProperty(globalThis,"FAST",Object.assign({value:Object.create(null)},ni));const R=globalThis.FAST;if(R.getById===void 0){const n=Object.create(null);Reflect.defineProperty(R,"getById",Object.assign({value(e,t){let i=n[e];return i===void 0&&(i=t?n[e]=t():null),i}},ni))}R.error===void 0&&Object.assign(R,{warn(){},error(n){return new Error(`Code ${n}`)},addMessages(){}});const ut=Object.freeze([]);function dt(){const n=new Map;return Object.freeze({register(e){return n.has(e.type)?!1:(n.set(e.type,e),!0)},getByType(e){return n.get(e)},getForInstance(e){return n.get(e.constructor)}})}const Ae=n=>typeof n=="function",H=n=>typeof n=="string",ie=R.getById(1,()=>{const n=[],e=[],t=globalThis.requestAnimationFrame;let i=!0;function s(){if(e.length)throw e.shift()}function r(l){try{l.call()}catch(h){if(i)e.push(h),setTimeout(s,0);else throw n.length=0,h}}function o(){let h=0;for(;h<n.length;)if(r(n[h]),h++,h>1024){for(let c=0,u=n.length-h;c<u;c++)n[c]=n[c+h];n.length-=h,h=0}n.length=0}function a(l){n.push(l),n.length<2&&(i?t(o):o())}return Object.freeze({enqueue:a,next:()=>new Promise(a),process:o,setMode:l=>i=l})});class Ce{constructor(e,t){this.sub1=void 0,this.sub2=void 0,this.spillover=void 0,this.subject=e,this.sub1=t}has(e){return this.spillover===void 0?this.sub1===e||this.sub2===e:this.spillover.indexOf(e)!==-1}subscribe(e){const t=this.spillover;if(t===void 0){if(this.has(e))return;if(this.sub1===void 0){this.sub1=e;return}if(this.sub2===void 0){this.sub2=e;return}this.spillover=[this.sub1,this.sub2,e],this.sub1=void 0,this.sub2=void 0}else t.indexOf(e)===-1&&t.push(e)}unsubscribe(e){const t=this.spillover;if(t===void 0)this.sub1===e?this.sub1=void 0:this.sub2===e&&(this.sub2=void 0);else{const i=t.indexOf(e);i!==-1&&t.splice(i,1)}}notify(e){const t=this.spillover,i=this.subject;if(t===void 0){const s=this.sub1,r=this.sub2;s!==void 0&&s.handleChange(i,e),r!==void 0&&r.handleChange(i,e)}else for(let s=0,r=t.length;s<r;++s)t[s].handleChange(i,e)}}class ri{constructor(e){this.subscribers={},this.subjectSubscribers=null,this.subject=e}notify(e){var t,i;(t=this.subscribers[e])===null||t===void 0||t.notify(e),(i=this.subjectSubscribers)===null||i===void 0||i.notify(e)}subscribe(e,t){var i,s;let r;t?r=(i=this.subscribers[t])!==null&&i!==void 0?i:this.subscribers[t]=new Ce(this.subject):r=(s=this.subjectSubscribers)!==null&&s!==void 0?s:this.subjectSubscribers=new Ce(this.subject),r.subscribe(e)}unsubscribe(e,t){var i,s;t?(i=this.subscribers[t])===null||i===void 0||i.unsubscribe(e):(s=this.subjectSubscribers)===null||s===void 0||s.unsubscribe(e)}}const S=R.getById(2,()=>{const n=ie.enqueue,e=/(:|&&|\|\||if)/,t=new WeakMap,i=new WeakMap;let s,r=c=>{throw R.error(1101)};function o(c){var u;let d=(u=c.$fastController)!==null&&u!==void 0?u:t.get(c);return d===void 0&&(Array.isArray(c)?d=r(c):t.set(c,d=new ri(c))),d}function a(c){let u=i.get(c);if(u===void 0){let d=Reflect.getPrototypeOf(c);for(;u===void 0&&d!==null;)u=i.get(d),d=Reflect.getPrototypeOf(d);u=u===void 0?[]:u.slice(0),i.set(c,u)}return u}class l{constructor(u){this.name=u,this.field=`_${u}`,this.callback=`${u}Changed`}getValue(u){return s!==void 0&&s.watch(u,this.name),u[this.field]}setValue(u,d){const f=this.field,v=u[f];if(v!==d){u[f]=d;const b=u[this.callback];Ae(b)&&b.call(u,v,d),o(u).notify(this.name)}}}class h extends Ce{constructor(u,d,f=!1){super(u,d),this.binding=u,this.isVolatileBinding=f,this.needsRefresh=!0,this.needsQueue=!0,this.isAsync=!0,this.first=this,this.last=null,this.propertySource=void 0,this.propertyName=void 0,this.notifier=void 0,this.next=void 0}setMode(u){this.isAsync=this.needsQueue=u}observe(u,d){this.needsRefresh&&this.last!==null&&this.dispose();const f=s;s=this.needsRefresh?this:void 0,this.needsRefresh=this.isVolatileBinding;const v=this.binding(u,d!=null?d:T.default);return s=f,v}dispose(){if(this.last!==null){let u=this.first;for(;u!==void 0;)u.notifier.unsubscribe(this,u.propertyName),u=u.next;this.last=null,this.needsRefresh=this.needsQueue=this.isAsync}}watch(u,d){const f=this.last,v=o(u),b=f===null?this.first:{};if(b.propertySource=u,b.propertyName=d,b.notifier=v,v.subscribe(this,d),f!==null){if(!this.needsRefresh){let _;s=void 0,_=f.propertySource[f.propertyName],s=this,u===_&&(this.needsRefresh=!0)}f.next=b}this.last=b}handleChange(){this.needsQueue?(this.needsQueue=!1,n(this)):this.isAsync||this.call()}call(){this.last!==null&&(this.needsQueue=this.isAsync,this.notify(this))}*records(){let u=this.first;for(;u!==void 0;)yield u,u=u.next}}return Object.freeze({setArrayObserverFactory(c){r=c},getNotifier:o,track(c,u){s&&s.watch(c,u)},trackVolatile(){s&&(s.needsRefresh=!0)},notify(c,u){o(c).notify(u)},defineProperty(c,u){H(u)&&(u=new l(u)),a(c).push(u),Reflect.defineProperty(c,u.name,{enumerable:!0,get(){return u.getValue(this)},set(d){u.setValue(this,d)}})},getAccessors:a,binding(c,u,d=this.isVolatileBinding(c)){return new h(c,u,d)},isVolatileBinding(c){return e.test(c.toString())}})});function L(n,e){S.defineProperty(n,e)}const jt=R.getById(3,()=>{let n=null;return{get(){return n},set(e){n=e}}});class T{constructor(e=null,t=null){this.index=0,this.length=0,this.parent=e,this.parentContext=t}get event(){return jt.get()}get isEven(){return this.index%2===0}get isOdd(){return this.index%2!==0}get isFirst(){return this.index===0}get isInMiddle(){return!this.isFirst&&!this.isLast}get isLast(){return this.index===this.length-1}eventDetail(){return this.event.detail}eventTarget(){return this.event.target}updatePosition(e,t){this.index=e,this.length=t}createChildContext(e){return new T(e,this)}createItemContext(e,t){const i=Object.create(this);return i.index=e,i.length=t,i}static setEvent(e){jt.set(e)}static create(){return new T}}T.default=new T;S.defineProperty(T.prototype,"index");S.defineProperty(T.prototype,"length");class Z{constructor(e,t,i){this.index=e,this.removed=t,this.addedCount=i}adjustTo(e){let t=this.index;const i=e.length;return t>i?t=i-this.addedCount:t<0&&(t=i+this.removed.length+t-this.addedCount),this.index=t<0?0:t,this}}const Gi=Object.freeze({reset:1,splice:2,optimized:3}),oi=new Z(0,ut,0);oi.reset=!0;const ai=[oi];let ft=Object.freeze({support:Gi.splice,normalize(n,e,t){return n===void 0?t!=null?t:ut:ai},pop(n,e,t,i){const s=n.length>0,r=t.apply(n,i);return s&&e.addSplice(new Z(n.length,[r],0)),r},push(n,e,t,i){const s=t.apply(n,i);return e.addSplice(new Z(n.length-i.length,[],i.length).adjustTo(n)),s},reverse(n,e,t,i){const s=t.apply(n,i);return e.reset(n),s},shift(n,e,t,i){const s=n.length>0,r=t.apply(n,i);return s&&e.addSplice(new Z(0,[r],0)),r},sort(n,e,t,i){const s=t.apply(n,i);return e.reset(n),s},splice(n,e,t,i){const s=t.apply(n,i);return e.addSplice(new Z(+i[0],s,i.length>2?i.length-2:0).adjustTo(n)),s},unshift(n,e,t,i){const s=t.apply(n,i);return e.addSplice(new Z(0,[],i.length).adjustTo(n)),s}});Object.freeze({reset:ai,setDefaultStrategy(n){ft=n}});function ci(n,e,t){Reflect.defineProperty(n,e,{value:t,enumerable:!1})}class Ji extends Ce{constructor(e){super(e),this.oldCollection=void 0,this.splices=void 0,this.needsQueue=!0,this._strategy=null,this._lengthObserver=void 0,this.call=this.flush,ci(e,"$fastController",this)}get strategy(){return this._strategy}set strategy(e){this._strategy=e}get lengthObserver(){let e=this._lengthObserver;if(e===void 0){const t=this.subject;this._lengthObserver=e={length:t.length,handleChange(){this.length!==t.length&&(this.length=t.length,S.notify(e,"length"))}},this.subscribe(e)}return e}subscribe(e){this.flush(),super.subscribe(e)}addSplice(e){this.splices===void 0?this.splices=[e]:this.splices.push(e),this.enqueue()}reset(e){this.oldCollection=e,this.enqueue()}flush(){var e;const t=this.splices,i=this.oldCollection;t===void 0&&i===void 0||(this.needsQueue=!0,this.splices=void 0,this.oldCollection=void 0,this.notify(((e=this._strategy)!==null&&e!==void 0?e:ft).normalize(i,this.subject,t)))}enqueue(){this.needsQueue&&(this.needsQueue=!1,ie.enqueue(this))}}let xt=!1;const Wi=Object.freeze({enable(){if(xt)return;xt=!0,S.setArrayObserverFactory(e=>new Ji(e));const n=Array.prototype;n.$fastPatch||(ci(n,"$fastPatch",1),[n.pop,n.push,n.reverse,n.shift,n.sort,n.splice,n.unshift].forEach(e=>{n[e.name]=function(...t){var i;const s=this.$fastController;return s===void 0?e.apply(this,t):((i=s.strategy)!==null&&i!==void 0?i:ft)[e.name](this,s,e,t)}}))}}),Rt=new Map;let At;function li(n){return n.map(e=>e instanceof x?li(e.styles):[e]).reduce((e,t)=>e.concat(t),[])}class x{constructor(e){this.styles=e,this.targets=new WeakSet,this._strategy=null,this.behaviors=e.map(t=>t instanceof x?t.behaviors:null).reduce((t,i)=>i===null?t:t===null?i:t.concat(i),null)}get strategy(){return this._strategy===null&&this.withStrategy(At),this._strategy}addStylesTo(e){this.strategy.addStylesTo(e),this.targets.add(e)}removeStylesFrom(e){this.strategy.removeStylesFrom(e),this.targets.delete(e)}isAttachedTo(e){return this.targets.has(e)}withBehaviors(...e){return this.behaviors=this.behaviors===null?e:this.behaviors.concat(e),this}withStrategy(e){return this._strategy=new e(li(this.styles)),this}static setDefaultStrategy(e){At=e}}x.supportsAdoptedStyleSheets=Array.isArray(document.adoptedStyleSheets)&&"replace"in CSSStyleSheet.prototype;class Qi{constructor(e){this.sheets=e.map(t=>{if(t instanceof CSSStyleSheet)return t;let i=Rt.get(t);return i===void 0&&(i=new CSSStyleSheet,i.replaceSync(t),Rt.set(t,i)),i})}addStylesTo(e){e.adoptedStyleSheets=[...e.adoptedStyleSheets,...this.sheets]}removeStylesFrom(e){const t=this.sheets;e.adoptedStyleSheets=e.adoptedStyleSheets.filter(i=>t.indexOf(i)===-1)}}x.setDefaultStrategy(R.getById(5,()=>Qi));const Fe=dt(),hi=Object.freeze({getForInstance:Fe.getForInstance,getByType:Fe.getByType,define(n){return Fe.register({type:n}),n}});function ui(n,e){const t=[];let i="";const s=[],r=o=>{s.push(o)};for(let o=0,a=n.length-1;o<a;++o){i+=n[o];let l=e[o];hi.getForInstance(l)!==void 0&&(l=l.createCSS(r)),l instanceof x||l instanceof CSSStyleSheet?(i.trim()!==""&&(t.push(i),i=""),t.push(l)):i+=l}return i+=n[n.length-1],i.trim()!==""&&t.push(i),{styles:t,behaviors:s}}const re=(n,...e)=>{const{styles:t,behaviors:i}=ui(n,e),s=new x(t);return i.length?s.withBehaviors(...i):s};class di{constructor(e,t){this.behaviors=t,this.css="";const i=e.reduce((s,r)=>(H(r)?this.css+=r:s.push(r),s),[]);i.length&&(this.styles=new x(i))}createCSS(e){return this.behaviors.forEach(e),this.styles&&e(this),this.css}bind(e){e.$fastController.addStyles(this.styles)}unbind(e){e.$fastController.removeStyles(this.styles)}}hi.define(di);re.partial=(n,...e)=>{const{styles:t,behaviors:i}=ui(n,e);return new di(t,i)};const $e=Object.freeze({queueUpdate:ie.enqueue,nextUpdate:ie.next,processUpdates:ie.process,setAttribute(n,e,t){t==null?n.removeAttribute(e):n.setAttribute(e,t)},setBooleanAttribute(n,e,t){t?n.setAttribute(e,""):n.removeAttribute(e)}}),pt=`fast-${Math.random().toString(36).substring(2,8)}`,_e=`${pt}{`,ce=`}${pt}`,Ki=ce.length;let Yi=0;const fi=()=>`${pt}-${++Yi}`,Pe=Object.freeze({interpolation:n=>`${_e}${n}${ce}`,attribute:n=>`${fi()}="${_e}${n}${ce}"`,comment:n=>`<!--${_e}${n}${ce}-->`}),Ie=Object.freeze({parse(n,e){const t=n.split(_e);if(t.length===1)return null;const i=[];for(let s=0,r=t.length;s<r;++s){const o=t[s],a=o.indexOf(ce);let l;if(a===-1)l=o;else{const h=o.substring(0,a);i.push(e[h]),l=o.substring(a+Ki)}l!==""&&i.push(l)}return i}}),Ve=dt(),fe=Object.freeze({getForInstance:Ve.getForInstance,getByType:Ve.getByType,define(n,e){return e=e||{},e.type=n,Ve.register(e),n}}),j=Object.freeze({none:0,attribute:1,booleanAttribute:2,property:3,content:4,tokenList:5,event:6,assign(n,e){if(!e){n.aspectType=j.content;return}switch(n.sourceAspect=e,e[0]){case":":switch(n.targetAspect=e.substring(1),n.targetAspect){case"innerHTML":n.aspectType=j.property;break;case"classList":n.aspectType=j.tokenList;break;default:n.aspectType=j.property;break}break;case"?":n.targetAspect=e.substring(1),n.aspectType=j.booleanAttribute;break;case"@":n.targetAspect=e.substring(1),n.aspectType=j.event;break;default:e==="class"?(n.targetAspect="className",n.aspectType=j.property):(n.targetAspect=e,n.aspectType=j.attribute);break}}});class Xi{constructor(e){this.options=e}createBehavior(e){return this}createHTML(e){return Pe.attribute(e(this))}}const Zi=globalThis.TrustedHTML?n=>(e,t)=>{const i=n(e,t);if(i instanceof TrustedHTML)return i;throw R.error(1202)}:n=>n,vt=Object.freeze({define(n,e=ns){return Object.freeze({[1]:t=>new n(t,$e.setAttribute),[2]:t=>new n(t,$e.setBooleanAttribute),[3]:t=>new n(t,(i,s,r)=>i[s]=r),[4]:t=>new(es(n))(t,ts),[5]:t=>new n(t,is),[6]:t=>new e(t)})}}),mt=Object.freeze({define(n,e){const t=i=>({mode:t.mode,options:Object.assign({},e,i)});return t.options=e,t.mode=n,t}});class pi{constructor(e,t){this.directive=e,this.updateTarget=t}bind(e,t,i){}unbind(e,t,i){}createBehavior(e){return this}}function es(n){return class extends n{unbind(e,t,i){super.unbind(e,t,i);const r=i[this.directive.nodeId].$fastView;r!==void 0&&r.isComposed&&(r.unbind(),r.needsBindOnly=!0)}}}function ts(n,e,t,i,s){if(t==null&&(t=""),t.create){n.textContent="";let r=n.$fastView;r===void 0?r=t.create():n.$fastTemplate!==t&&(r.isComposed&&(r.remove(),r.unbind()),r=t.create()),r.isComposed?r.needsBindOnly&&(r.needsBindOnly=!1,r.bind(i,s)):(r.isComposed=!0,r.bind(i,s),r.insertBefore(n),n.$fastView=r,n.$fastTemplate=t)}else{const r=n.$fastView;r!==void 0&&r.isComposed&&(r.isComposed=!1,r.remove(),r.needsBindOnly?r.needsBindOnly=!1:r.unbind()),n.textContent=t}}function is(n,e,t){var i;const r=`${this.directive.id}-t`,o=(i=n[r])!==null&&i!==void 0?i:n[r]={c:0,v:Object.create(null)},a=o.v;let l=o.c;const h=n[e];if(t!=null&&t.length){const c=t.split(/\s+/);for(let u=0,d=c.length;u<d;++u){const f=c[u];f!==""&&(a[f]=l,h.add(f))}}if(o.v=l+1,l!==0){l-=1;for(const c in a)a[c]===l&&h.remove(c)}}class ss extends pi{bind(e,t,i){const s=this.directive;this.updateTarget(i[s.nodeId],s.targetAspect,s.binding(e,t),e,t)}}class vi extends pi{constructor(e,t){super(e,t),this.isBindingVolatile=S.isVolatileBinding(e.binding),this.observerProperty=`${e.id}-o`}getObserver(e){var t;return(t=e[this.observerProperty])!==null&&t!==void 0?t:e[this.observerProperty]=S.binding(this.directive.binding,this,this.isBindingVolatile)}bind(e,t,i){const s=this.directive,r=i[s.nodeId],o=this.getObserver(r);o.target=r,o.source=e,o.context=t,this.updateTarget(r,s.targetAspect,o.observe(e,t),e,t)}unbind(e,t,i){const s=i[this.directive.nodeId],r=this.getObserver(s);r.dispose(),r.target=null,r.source=null,r.context=null}handleChange(e,t){const i=t.target,s=t.source,r=t.context;this.updateTarget(i,this.directive.targetAspect,t.observe(s,r),s,r)}}class ns{constructor(e){this.directive=e,this.sourceProperty=`${e.id}-s`,this.contextProperty=`${e.id}-c`}bind(e,t,i){const s=this.directive,r=i[s.nodeId];r[this.sourceProperty]=e,r[this.contextProperty]=t,r.addEventListener(s.targetAspect,this,s.options)}unbind(e,t,i){const s=this.directive,r=i[s.nodeId];r[this.sourceProperty]=r[this.contextProperty]=null,r.removeEventListener(s.targetAspect,this,s.options)}createBehavior(e){return this}handleEvent(e){const t=e.currentTarget;T.setEvent(e);const i=this.directive.binding(t[this.sourceProperty],t[this.contextProperty]);T.setEvent(null),i!==!0&&e.preventDefault()}}const Pt=mt.define(vt.define(vi),{}),Je=mt.define(vt.define(ss),{once:!0});class mi{constructor(e,t,i){this.binding=e,this.mode=t,this.options=i,this.factory=null,this.aspectType=j.content}createHTML(e){return Pe.interpolation(e(this))}createBehavior(e){return this.factory==null&&(this.targetAspect==="innerHTML"&&(this.binding=Zi(this.binding)),this.factory=this.mode[this.aspectType](this)),this.factory.createBehavior(e)}}fe.define(mi,{aspected:!0});function K(n,e=Pt){return"mode"in e||(e=Pt(e)),new mi(n,e.mode,e.options)}function It(n,e){const t=n.parentNode;let i=n,s;for(;i!==e;)s=i.nextSibling,t.removeChild(i),i=s;t.removeChild(e)}class gt{constructor(e,t,i){this.fragment=e,this.factories=t,this.targets=i,this.behaviors=null,this.source=null,this.context=null,this.firstChild=e.firstChild,this.lastChild=e.lastChild}appendTo(e){e.appendChild(this.fragment)}insertBefore(e){if(this.fragment.hasChildNodes())e.parentNode.insertBefore(this.fragment,e);else{const t=e.parentNode,i=this.lastChild;let s=this.firstChild,r;for(;s!==i;)r=s.nextSibling,t.insertBefore(s,e),s=r;t.insertBefore(i,e)}}remove(){const e=this.fragment,t=this.lastChild;let i=this.firstChild,s;for(;i!==t;)s=i.nextSibling,e.appendChild(i),i=s;e.appendChild(t)}dispose(){It(this.firstChild,this.lastChild),this.unbind()}bind(e,t){let i=this.behaviors;const s=this.source;if(s===e)return;this.source=e,this.context=t;const r=this.targets;if(s!==null)for(let o=0,a=i.length;o<a;++o){const l=i[o];l.unbind(s,t,r),l.bind(e,t,r)}else if(i===null){this.behaviors=i=new Array(this.factories.length);const o=this.factories;for(let a=0,l=o.length;a<l;++a){const h=o[a].createBehavior(r);h.bind(e,t,r),i[a]=h}}else for(let o=0,a=i.length;o<a;++o)i[o].bind(e,t,r)}unbind(){const e=this.source;if(e===null)return;const t=this.targets,i=this.context,s=this.behaviors;for(let r=0,o=s.length;r<o;++r)s[r].unbind(e,i,t);this.source=null,this.context=null}static disposeContiguousBatch(e){if(e.length!==0){It(e[0].firstChild,e[e.length-1].lastChild);for(let t=0,i=e.length;t<i;++t)e[t].unbind()}}}const gi=(n,e)=>`${n}.${e}`,Nt={},B={index:0,node:null};class rs{constructor(e,t){this.fragment=e,this.directives=t,this.proto=null,this.nodeIds=new Set,this.descriptors={},this.factories=[]}addFactory(e,t,i,s){this.nodeIds.has(i)||(this.nodeIds.add(i),this.addTargetDescriptor(t,i,s)),e.nodeId=i,this.factories.push(e)}freeze(){return this.proto=Object.create(null,this.descriptors),this}addTargetDescriptor(e,t,i){const s=this.descriptors;if(t==="r"||t==="h"||s[t])return;if(!s[e]){const o=e.lastIndexOf("."),a=e.substring(0,o),l=parseInt(e.substring(o+1));this.addTargetDescriptor(a,e,l)}let r=Nt[t];if(!r){const o=`_${t}`;Nt[t]=r={get(){var a;return(a=this[o])!==null&&a!==void 0?a:this[o]=this[e].childNodes[i]}}}s[t]=r}createView(e){const t=this.fragment.cloneNode(!0),i=Object.create(this.proto);i.r=t,i.h=e!=null?e:t;for(const s of this.nodeIds)i[s];return new gt(t,this.factories,i)}}function bi(n,e,t,i,s,r=!1){const o=t.attributes,a=n.directives;for(let l=0,h=o.length;l<h;++l){const c=o[l],u=c.value,d=Ie.parse(u,a);let f=null;d===null?r&&(f=K(()=>u,Je),j.assign(f,c.name)):f=bt.aggregate(d),f!==null&&(t.removeAttributeNode(c),l--,h--,n.addFactory(f,e,i,s))}}function os(n,e,t,i,s){const r=Ie.parse(e.textContent,n.directives);if(r===null)return B.node=e.nextSibling,B.index=s+1,B;let o,a=o=e;for(let l=0,h=r.length;l<h;++l){const c=r[l];l!==0&&(s++,i=gi(t,s),o=a.parentNode.insertBefore(document.createTextNode(""),a.nextSibling)),H(c)?o.textContent=c:(o.textContent=" ",j.assign(c),n.addFactory(c,t,i,s)),a=o}return B.index=s+1,B.node=a.nextSibling,B}function yi(n,e,t){let i=0,s=e.firstChild;for(;s;){const r=as(n,t,s,i);s=r.node,i=r.index}}function as(n,e,t,i){const s=gi(e,i);switch(t.nodeType){case 1:bi(n,e,t,s,i),yi(n,t,s);break;case 3:return os(n,t,e,s,i);case 8:const r=Ie.parse(t.data,n.directives);r!==null&&n.addFactory(bt.aggregate(r),e,s,i);break}return B.index=i+1,B.node=t.nextSibling,B}function cs(n,e){return n&&n.nodeType==8&&Ie.parse(n.data,e)!==null}const Dt="TEMPLATE",Bt={createHTML:n=>n};let Se=globalThis.trustedTypes?globalThis.trustedTypes.createPolicy("fast-html",Bt):Bt;const ls=Se,bt={setHTMLPolicy(n){if(Se!==ls)throw R.error(1201);Se=n},compile(n,e){let t;if(H(n)){t=document.createElement(Dt),t.innerHTML=Se.createHTML(n);const r=t.content.firstElementChild;r!==null&&r.tagName===Dt&&(t=r)}else t=n;const i=document.adoptNode(t.content),s=new rs(i,e);return bi(s,"",t,"h",0,!0),(cs(i.firstChild,e)||i.childNodes.length===1&&Object.keys(e).length>0)&&i.insertBefore(document.createComment(""),i.firstChild),yi(s,i,"r"),B.node=null,s.freeze()},setDefaultStrategy(n){this.compile=n},aggregate(n){if(n.length===1)return n[0];let e;const t=n.length,i=n.map(o=>H(o)?()=>o:(e=o.sourceAspect||e,o.binding)),r=K((o,a)=>{let l="";for(let h=0;h<t;++h)l+=i[h](o,a);return l});return j.assign(r,e),r}};class wi{constructor(e,t){this.result=null,this.html=e,this.factories=t}create(e){return this.result===null&&(this.result=bt.compile(this.html,this.factories)),this.result.createView(e)}render(e,t,i,s){const r=this.create(i!=null?i:t);return r.bind(e,s!=null?s:T.default),r.appendTo(t),r}}const _i=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;function He(n,e,t){const i=_i.exec(e);return i!==null&&j.assign(n,i[2]),n.createHTML(t)}function E(n,...e){let t="";const i=Object.create(null),s=r=>{var o;const a=(o=r.id)!==null&&o!==void 0?o:r.id=fi();return i[a]=r,a};for(let r=0,o=n.length-1;r<o;++r){const a=n[r],l=e[r];let h;if(t+=a,Ae(l))t+=He(K(l),a,s);else if(H(l)){const c=_i.exec(a);if(c!==null){const u=K(()=>l,Je);j.assign(u,c[2]),t+=u.createHTML(s)}else t+=l}else(h=fe.getForInstance(l))===void 0?t+=He(K(()=>l,Je),a,s):h.aspected?t+=He(l,a,s):t+=l.createHTML(s)}return new wi(t+n[n.length-1],i)}class Si extends Xi{bind(e,t,i){e[this.options]=i[this.nodeId]}unbind(){}}fe.define(Si);const Lt=n=>new Si(n);function Ci(n,e){const t=Ae(e)?e:()=>e;return(i,s)=>n(i,s)?t(i,s):null}const hs=Object.freeze({positioning:!1,recycle:!0});function us(n,e,t,i){n.bind(e[t],i)}function ds(n,e,t,i){n.bind(e[t],i.createItemContext(t,e.length))}class fs{constructor(e,t,i,s,r,o){this.location=e,this.itemsBinding=t,this.templateBinding=s,this.options=o,this.source=null,this.views=[],this.items=null,this.itemsObserver=null,this.context=void 0,this.childContext=void 0,this.bindView=us,this.itemsBindingObserver=S.binding(t,this,i),this.templateBindingObserver=S.binding(s,this,r),o.positioning&&(this.bindView=ds)}bind(e,t){this.source=e,this.context=t,this.childContext=t.createChildContext(e),this.items=this.itemsBindingObserver.observe(e,this.context),this.template=this.templateBindingObserver.observe(e,this.context),this.observeItems(!0),this.refreshAllViews()}unbind(){this.source=null,this.items=null,this.itemsObserver!==null&&this.itemsObserver.unsubscribe(this),this.unbindAllViews(),this.itemsBindingObserver.dispose(),this.templateBindingObserver.dispose()}handleChange(e,t){e===this.itemsBinding?(this.items=this.itemsBindingObserver.observe(this.source,this.context),this.observeItems(),this.refreshAllViews()):e===this.templateBinding?(this.template=this.templateBindingObserver.observe(this.source,this.context),this.refreshAllViews(!0)):t[0].reset?this.refreshAllViews():this.updateViews(t)}observeItems(e=!1){if(!this.items){this.items=ut;return}const t=this.itemsObserver,i=this.itemsObserver=S.getNotifier(this.items),s=t!==i;s&&t!==null&&t.unsubscribe(this),(s||e)&&i.subscribe(this)}updateViews(e){const t=this.views,i=this.childContext,s=[],r=this.bindView;let o=0;for(let h=0,c=e.length;h<c;++h){const u=e[h],d=u.removed;s.push(...t.splice(u.index+o,d.length)),o-=u.addedCount}const a=this.items,l=this.template;for(let h=0,c=e.length;h<c;++h){const u=e[h];let d=u.index;const f=d+u.addedCount;for(;d<f;++d){const v=t[d],b=v?v.firstChild:this.location,_=this.options.recycle&&s.length>0?s.shift():l.create();t.splice(d,0,_),r(_,a,d,i),_.insertBefore(b)}}for(let h=0,c=s.length;h<c;++h)s[h].dispose();if(this.options.positioning)for(let h=0,c=t.length;h<c;++h)t[h].context.updatePosition(h,c)}refreshAllViews(e=!1){const t=this.items,i=this.template,s=this.location,r=this.bindView,o=this.childContext;let a=t.length,l=this.views,h=l.length;if((a===0||e||!this.options.recycle)&&(gt.disposeContiguousBatch(l),h=0),h===0){this.views=l=new Array(a);for(let c=0;c<a;++c){const u=i.create();r(u,t,c,o),l[c]=u,u.insertBefore(s)}}else{let c=0;for(;c<a;++c)if(c<h){const d=l[c];r(d,t,c,o)}else{const d=i.create();r(d,t,c,o),l.push(d),d.insertBefore(s)}const u=l.splice(c,h-c);for(c=0,a=u.length;c<a;++c)u[c].dispose()}}unbindAllViews(){const e=this.views;for(let t=0,i=e.length;t<i;++t)e[t].unbind()}}class $i{constructor(e,t,i){this.itemsBinding=e,this.templateBinding=t,this.options=i,Wi.enable(),this.isItemsBindingVolatile=S.isVolatileBinding(e),this.isTemplateBindingVolatile=S.isVolatileBinding(t)}createHTML(e){return Pe.comment(e(this))}createBehavior(e){return new fs(e[this.nodeId],this.itemsBinding,this.isItemsBindingVolatile,this.templateBinding,this.isTemplateBindingVolatile,this.options)}}fe.define($i);function Te(n,e,t=hs){const i=Ae(e)?e:()=>e;return new $i(n,i,t)}const Ut="boolean",Mt="reflect",ps={toView(n){return n?"true":"false"},fromView(n){return!(n==null||n==="false"||n===!1||n===0)}};class Oe{constructor(e,t,i=t.toLowerCase(),s=Mt,r){this.guards=new Set,this.Owner=e,this.name=t,this.attribute=i,this.mode=s,this.converter=r,this.fieldName=`_${t}`,this.callbackName=`${t}Changed`,this.hasCallback=this.callbackName in e.prototype,s===Ut&&r===void 0&&(this.converter=ps)}setValue(e,t){const i=e[this.fieldName],s=this.converter;s!==void 0&&(t=s.fromView(t)),i!==t&&(e[this.fieldName]=t,this.tryReflectToAttribute(e),this.hasCallback&&e[this.callbackName](i,t),e.$fastController.notify(this.name))}getValue(e){return S.track(e,this.name),e[this.fieldName]}onAttributeChangedCallback(e,t){this.guards.has(e)||(this.guards.add(e),this.setValue(e,t),this.guards.delete(e))}tryReflectToAttribute(e){const t=this.mode,i=this.guards;i.has(e)||t==="fromView"||ie.enqueue(()=>{i.add(e);const s=e[this.fieldName];switch(t){case Mt:const r=this.converter;$e.setAttribute(e,this.attribute,r!==void 0?r.toView(s):s);break;case Ut:$e.setBooleanAttribute(e,this.attribute,s);break}i.delete(e)})}static collect(e,...t){const i=[];t.push(e.attributes);for(let s=0,r=t.length;s<r;++s){const o=t[s];if(o!==void 0)for(let a=0,l=o.length;a<l;++a){const h=o[a];H(h)?i.push(new Oe(e,h)):i.push(new Oe(e,h.property,h.attribute,h.mode,h.converter))}}return i}}function pe(n,e){let t;function i(s,r){arguments.length>1&&(t.property=r),(s.constructor.attributes||(s.constructor.attributes=[])).push(t)}if(arguments.length>1){t={},i(n,e);return}return t=n===void 0?{}:n,i}const zt={mode:"open"},Ft={},ke=R.getById(4,()=>dt());class ne{constructor(e,t=e.definition){H(t)&&(t={name:t}),this.type=e,this.name=t.name,this.template=t.template;const i=Oe.collect(e,t.attributes),s=new Array(i.length),r={},o={};for(let a=0,l=i.length;a<l;++a){const h=i[a];s[a]=h.attribute,r[h.name]=h,o[h.attribute]=h}this.attributes=i,this.observedAttributes=s,this.propertyLookup=r,this.attributeLookup=o,this.shadowOptions=t.shadowOptions===void 0?zt:t.shadowOptions===null?void 0:Object.assign(Object.assign({},zt),t.shadowOptions),this.elementOptions=t.elementOptions===void 0?Ft:Object.assign(Object.assign({},Ft),t.elementOptions),this.styles=t.styles===void 0?void 0:Array.isArray(t.styles)?new x(t.styles):t.styles instanceof x?t.styles:new x([t.styles])}get isDefined(){return!!ke.getByType(this.type)}define(e=customElements){const t=this.type;if(ke.register(this)){const i=this.attributes,s=t.prototype;for(let r=0,o=i.length;r<o;++r)S.defineProperty(s,i[r]);Reflect.defineProperty(t,"observedAttributes",{value:this.observedAttributes,enumerable:!0})}return e.get(this.name)||e.define(this.name,t,this.elementOptions),this}}ne.getByType=ke.getByType;ne.getForInstance=ke.getForInstance;const Ti=new WeakMap,vs={bubbles:!0,composed:!0,cancelable:!0};function qe(n){var e,t;return(t=(e=n.shadowRoot)!==null&&e!==void 0?e:Ti.get(n))!==null&&t!==void 0?t:null}const Vt="isConnected";class yt extends ri{constructor(e,t){super(e),this.boundObservables=null,this.behaviors=null,this.needsInitialization=!0,this.hasExistingShadowRoot=!1,this._template=null,this._styles=null,this._isConnected=!1,this.$fastController=this,this.view=null,this.element=e,this.definition=t;const i=t.shadowOptions;if(i!==void 0){let r=e.shadowRoot;r?this.hasExistingShadowRoot=!0:(r=e.attachShadow(i),i.mode==="closed"&&Ti.set(e,r))}const s=S.getAccessors(e);if(s.length>0){const r=this.boundObservables=Object.create(null);for(let o=0,a=s.length;o<a;++o){const l=s[o].name,h=e[l];h!==void 0&&(delete e[l],r[l]=h)}}}get isConnected(){return S.track(this,Vt),this._isConnected}setIsConnected(e){this._isConnected=e,S.notify(this,Vt)}get template(){var e;if(this._template===null){const t=this.definition;this.element.resolveTemplate?this._template=this.element.resolveTemplate():t.template&&(this._template=(e=t.template)!==null&&e!==void 0?e:null)}return this._template}set template(e){this._template!==e&&(this._template=e,this.needsInitialization||this.renderTemplate(e))}get styles(){var e;if(this._styles===null){const t=this.definition;this.element.resolveStyles?this._styles=this.element.resolveStyles():t.styles&&(this._styles=(e=t.styles)!==null&&e!==void 0?e:null)}return this._styles}set styles(e){this._styles!==e&&(this._styles!==null&&this.removeStyles(this._styles),this._styles=e,this.needsInitialization||this.addStyles(e))}addStyles(e){if(!e)return;const t=qe(this.element)||this.element.getRootNode();if(e instanceof HTMLElement)t.append(e);else if(!e.isAttachedTo(t)){const i=e.behaviors;e.addStylesTo(t),i!==null&&this.addBehaviors(i)}}removeStyles(e){if(!e)return;const t=qe(this.element)||this.element.getRootNode();if(e instanceof HTMLElement)t.removeChild(e);else if(e.isAttachedTo(t)){const i=e.behaviors;e.removeStylesFrom(t),i!==null&&this.removeBehaviors(i)}}addBehaviors(e){var t;const i=(t=this.behaviors)!==null&&t!==void 0?t:this.behaviors=new Map,s=e.length,r=[];for(let o=0;o<s;++o){const a=e[o];i.has(a)?i.set(a,i.get(a)+1):(i.set(a,1),r.push(a))}if(this._isConnected){const o=this.element,a=T.default;for(let l=0;l<r.length;++l)r[l].bind(o,a)}}removeBehaviors(e,t=!1){const i=this.behaviors;if(i===null)return;const s=e.length,r=[];for(let o=0;o<s;++o){const a=e[o];if(i.has(a)){const l=i.get(a)-1;l===0||t?i.delete(a)&&r.push(a):i.set(a,l)}}if(this._isConnected){const o=this.element,a=T.default;for(let l=0;l<r.length;++l)r[l].unbind(o,a)}}onConnectedCallback(){if(this._isConnected)return;const e=this.element,t=T.default;this.needsInitialization?this.finishInitialization():this.view!==null&&this.view.bind(e,t);const i=this.behaviors;if(i!==null)for(const s of i.keys())s.bind(e,t);this.setIsConnected(!0)}onDisconnectedCallback(){if(!this._isConnected)return;this.setIsConnected(!1);const e=this.view;e!==null&&e.unbind();const t=this.behaviors;if(t!==null){const i=this.element,s=T.default;for(const r of t.keys())r.unbind(i,s)}}onAttributeChangedCallback(e,t,i){const s=this.definition.attributeLookup[e];s!==void 0&&s.onAttributeChangedCallback(this.element,i)}emit(e,t,i){return this._isConnected?this.element.dispatchEvent(new CustomEvent(e,Object.assign(Object.assign({detail:t},vs),i))):!1}finishInitialization(){const e=this.element,t=this.boundObservables;if(t!==null){const i=Object.keys(t);for(let s=0,r=i.length;s<r;++s){const o=i[s];e[o]=t[o]}this.boundObservables=null}this.renderTemplate(this.template),this.addStyles(this.styles),this.needsInitialization=!1}renderTemplate(e){var t;const i=this.element,s=(t=qe(i))!==null&&t!==void 0?t:i;if(this.view!==null)this.view.dispose(),this.view=null;else if(!this.needsInitialization||this.hasExistingShadowRoot){this.hasExistingShadowRoot=!1;for(let r=s.firstChild;r!==null;r=s.firstChild)s.removeChild(r)}e&&(this.view=e.render(i,s,i))}static forCustomElement(e){const t=e.$fastController;if(t!==void 0)return t;const i=ne.getForInstance(e);if(i===void 0)throw R.error(1401);return e.$fastController=new yt(e,i)}}function Ht(n){return class extends n{constructor(){super(),yt.forCustomElement(this)}$emit(e,t,i){return this.$fastController.emit(e,t,i)}connectedCallback(){this.$fastController.onConnectedCallback()}disconnectedCallback(){this.$fastController.onDisconnectedCallback()}attributeChangedCallback(e,t,i){this.$fastController.onAttributeChangedCallback(e,t,i)}}}const z=Object.assign(Ht(HTMLElement),{from(n){return Ht(n)},define(n,e){return this.metadata(n,e).define().type},metadata(n,e){return new ne(n,e)}});function A(n){return function(e){z.define(e,n)}}var ms=Object.defineProperty,gs=Object.getOwnPropertyDescriptor,Oi=(n,e,t,i)=>{for(var s=i>1?void 0:i?gs(e,t):e,r=n.length-1,o;r>=0;r--)(o=n[r])&&(s=(i?o(e,t,s):o(s))||s);return i&&s&&ms(e,t,s),s};let $=class extends z{constructor(){super(...arguments),this.activated="smoke",this.stuffs=["smoke","flash","molotov","grenade"]}static setupNewStream(){var n;(n=$.stuffActivatedReader)==null||n.cancel(),$.stuffActivated$=ht(e=>{$.controller=e}),$.stuffActivatedReader=$.stuffActivated$.getReader()}connectedCallback(){$.setupNewStream(),super.connectedCallback()}activate(n){this.activated=n,$.stuffActivated=n,$.controller.enqueue(n)}capitalizeFirstLetter(n){return n.charAt(0).toUpperCase()+n.slice(1)}};$.stuffActivated="smoke";Oi([pe],$.prototype,"activated",2);$=Oi([A({name:"app-stuff-selector",styles:re`
		ul {
			margin: 0;
			padding: 0;
			background: #000;
			height: 100vh;
			width: calc((100vw - 100vh) / 2);
		}

		li {
			list-style-type: none;
			cursor: pointer;
			padding: 10px 20px;
			color: #fff;
			font-size: 1.5rem;
			display: block;
		}

		li:hover,
		li.activated {
			background: #212121;
		}

		.activated {
			font-weight: 700;
		}
	`,template:E`
		<ul>
			${Te(n=>n.stuffs,E`
					<li
						@click="${(n,e)=>e.parent.activate(n)}"
						class="${(n,e)=>e.parent.activated===n?"activated":""}"
					>
						${(n,e)=>e.parent.capitalizeFirstLetter(n)}
					</li>
				`)}
		</ul>
	`})],$);async function wt(n,e){let t=!1;do{const i=await bs(n);i.done||e(i.value),t=i.done}while(!t)}async function bs(n){return await n.read()}const _t=class{constructor(){return this.actualMapName$=ht(n=>{this.controller=n}),_t.instance}onNavigationEnd(n,e){const t=e.endpoint.path.split("/")[1];this.controller.enqueue(t)}onUnhandledNavigationMessage(){}onNavigationBegin(){}onPhaseBegin(){}onPhaseEnd(){}};let St=_t;St.instance=new _t;let qt={determineChangeEvent(){return"change"}};class ys extends vi{bind(e,t,i){var s;super.bind(e,t,i);const r=this.directive,o=i[r.nodeId];this.changeEvent||(this.changeEvent=(s=r.options.changeEvent)!==null&&s!==void 0?s:qt.determineChangeEvent(r,o)),o.addEventListener(this.changeEvent,this)}unbind(e,t,i){super.unbind(e,t,i),i[this.directive.nodeId].removeEventListener(this.changeEvent,this)}handleEvent(e){const t=this.directive,i=e.currentTarget,r=this.getObserver(i).last;if(!r){R.warn(1203);return}let o;switch(t.aspectType){case 1:o=i.getAttribute(t.targetAspect);break;case 2:o=i.hasAttribute(t.targetAspect);break;case 4:o=i.innerText;break;default:o=i[t.targetAspect];break}r.propertySource[r.propertyName]=t.options.fromView(o)}static configure(e){qt=e}}const ki=mt.define(vt.define(ys),{fromView:n=>n});var ws=Object.defineProperty,_s=Object.getOwnPropertyDescriptor,Ct=(n,e,t,i)=>{for(var s=i>1?void 0:i?_s(e,t):e,r=n.length-1,o;r>=0;r--)(o=n[r])&&(s=(i?o(e,t,s):o(s))||s);return i&&s&&ws(e,t,s),s};let Ee=class extends z{constructor(){super(...arguments),this.user=null,this._editing=!1,this.mapNames=["de_ancient","de_dust2","de_inferno","de_mirage","de_nuke","de_overpass","de_vertigo"]}get editing(){return S.track(this,"editing"),this._editing}set editing(n){this._editing=n,w.editing=n,w.controller.enqueue(n),S.notify(this,"editing")}connectedCallback(){super.connectedCallback();const n=St.instance.actualMapName$.getReader();wt(n,e=>{this.actualMapName=e}),this.getUser(),w.supabase.auth.onAuthStateChange(()=>{this.getUser()})}getUser(){this.user=w.supabase.auth.user()}};Ct([L],Ee.prototype,"actualMapName",2);Ct([L],Ee.prototype,"user",2);Ee=Ct([A({name:"app-nav",styles:re`
		ul {
			padding: 0;
			margin: 0;
			background: #000;
			height: 100vh;
			width: calc((100vw - 100vh) / 2);
			display: flex;
			flex-direction: column;
		}

		li {
			list-style-type: none;
		}

		li > * {
			padding: 10px 20px;
			color: #fff;
			font-size: 1.5rem;
			display: block;
		}

		.edit {
			flex-grow: 1;
			display: flex;
			align-items: end;
		}

		h1 {
			margin: 0;
		}

		a {
			text-decoration: none;
		}

		a:hover,
		a.activated {
			background: #212121;
		}

		.activated {
			font-weight: 700;
		}
	`,template:E`
		<ul>
			<li>
				<h1>CS:GO Helpers</h1>
			</li>

			${Te(n=>n.mapNames,E`
					<li>
						<a
							href="/csgo-helpers/${n=>n}"
							class="${(n,e)=>e.parent.actualMapName===n?"activated":""}"
						>
							${n=>n}
						</a>
					</li>
				`)}
			${Ci(n=>!!n.user,E`
					<li class="edit">
						<label>
							<input
								type="checkbox"
								:checked="${K(n=>n.editing,ki)}"
							/>

							Éditer
						</label>
					</li>
				`)}
		</ul>
	`})],Ee);function Ss(n,e,t,i){var s=arguments.length,r=s<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(r=(s<3?o(r):s>3?o(e,t,r):o(e,t))||r);return s>3&&r&&Object.defineProperty(e,t,r),r}function p(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(c){try{h(i.next(c))}catch(u){o(u)}}function l(c){try{h(i.throw(c))}catch(u){o(u)}}function h(c){c.done?r(c.value):s(c.value).then(a,l)}h((i=i.apply(n,e||[])).next())})}function Cs(n){const e=n.parentElement;if(e)return e;{const t=n.getRootNode();if(t.host instanceof HTMLElement)return t.host}return null}class je{constructor(e){this.path=e}}const We=new Set,Gt=Object.freeze({register(n){We.add(n)},unregister(n){We.delete(n)}}),Jt=/^([a-z][a-z0-9+\-.]*:)?\/\//i,I=Object.freeze({path:Object.freeze({get current(){return location.pathname+location.search},generateRoute(n,e,t={}){return p(this,void 0,void 0,function*(){let i="config"in n?n:ue.find(n);for(;i!==null;){const s=yield i.config.generateRouteFromPath(e,t);if(s!==null)return s;i=i.parent}return null})},push(n,e=!0){if(n&&Jt.test(n)){location.href=n;return}history.pushState({},document.title,n),e&&I.path.trigger(n)},replace(n,e=!0){if(n&&Jt.test(n)){location.href=n;return}history.replaceState({},document.title,n),e&&I.path.trigger(n)},trigger(n){const e=new je(n);for(const t of We)t.enqueue(e)}}),name:Object.freeze({generateRoute(n,e,t={}){return p(this,void 0,void 0,function*(){let i="config"in n?n:ue.find(n);for(;i!==null;){const s=yield i.config.generateRouteFromName(e,t);if(s!==null)return s;i=i.parent}return null})},push(n,e,t={},i=!0){return p(this,void 0,void 0,function*(){const s=yield I.name.generateRoute(n,e,t);s!==null&&I.path.push(s,i)})},replace(n,e,t={},i=!0){return p(this,void 0,void 0,function*(){const s=yield I.name.generateRoute(n,e,t);s!==null&&I.path.replace(s,i)})},trigger(n,e,t={}){return p(this,void 0,void 0,function*(){const i=yield I.name.generateRoute(n,e,t);i!==null&&I.path.trigger(i)})}})});class $s{constructor(){this.queue=[],this.promise=null,this.resolve=null}connect(){this.enqueue(new je(I.path.current)),window.addEventListener("popstate",this),Gt.register(this)}disconnect(){this.queue=[],this.promise=null,this.resolve=null,window.removeEventListener("popstate",this),Gt.unregister(this)}receive(){return this.promise!==null?this.promise:(this.promise=new Promise(e=>this.resolve=e),Promise.resolve().then(()=>this.tryDequeue()),this.promise)}enqueue(e){this.queue.push(e),this.tryDequeue()}tryDequeue(){if(this.resolve===null||this.queue.length===0)return;const e=this.queue[this.queue.length-1],t=this.resolve;this.queue.length=0,this.promise=null,this.resolve=null,t(e)}handleEvent(e){this.enqueue(new je(I.path.current))}}const Qe=encodeURIComponent,Wt=n=>Qe(n).replace("%24","$");function Ke(n,e,t){let i=[];if(e==null)return i;if(Array.isArray(e))for(let s=0,r=e.length;s<r;s++)if(t)i.push(`${Wt(n)}=${Qe(e[s])}`);else{const o=n+"["+(typeof e[s]=="object"&&e[s]!==null?s:"")+"]";i=i.concat(Ke(o,e[s]))}else if(typeof e=="object"&&!t)for(const s in e)i=i.concat(Ke(n+"["+s+"]",e[s]));else i.push(`${Wt(n)}=${Qe(e)}`);return i}function Ts(n,e){return Array.isArray(n)?(n.push(e),n):n!==void 0?[n,e]:e}function Os(n,e,t){let i=n;const s=e.length-1;for(let r=0;r<=s;r++){const o=e[r]===""?i.length:e[r];if(r<s){const a=!i[o]||typeof i[o]=="object"?i[o]:[i[o]];i=i[o]=a||(isNaN(e[r+1])?{}:[])}else i=i[o]=t}}const le=Object.freeze({get current(){return location.search},build(n,e){let t=[];const i=Object.keys(n||{}).sort();for(let s=0,r=i.length;s<r;s++){const o=i[s];t=t.concat(Ke(o,n[o],e))}return t.length===0?"":t.join("&")},separate(n){const e=n.indexOf("?");let t="";return e!==-1&&(t=n.substr(e+1,n.length),n=n.substr(0,e)),{path:n,queryString:t}},parse(n){const e={};if(!n||typeof n!="string")return e;let t=n;t.charAt(0)==="?"&&(t=t.substr(1));const i=t.replace(/\+/g," ").split("&");for(let s=0;s<i.length;s++){const r=i[s].split("="),o=decodeURIComponent(r[0]);if(!o)continue;let a=o.split("]["),l=a.length-1;if(/\[/.test(a[0])&&/\]$/.test(a[l])?(a[l]=a[l].replace(/\]$/,""),a=a.shift().split("[").concat(a),l=a.length-1):l=0,r.length>=2){const h=r[1]?decodeURIComponent(r[1]):"";l?Os(e,a,h):e[o]=Ts(e[o],h)}else e[o]=!0}return e}}),ks=n=>n;class Ei{constructor(e,t,i){this.path=e,this.name=t,this.caseSensitive=i}}class ji{constructor(e,t,i,s){this.route=e,this.paramNames=t,this.paramTypes=i,this.settings=s}get path(){return this.route.path}}class xi{constructor(e,t,i,s){this.endpoint=e,this.params=t,this.typedParams=i,this.queryParams=s,this.allParams=Object.assign(Object.assign({},t),s),this.allTypedParams=Object.assign(Object.assign({},i),s)}get settings(){return this.endpoint.settings}}class $t{constructor(e,t,i,s){var r;this.chars=e,this.states=t,this.skippedStates=i,this.result=s,this.head=t[t.length-1],this.endpoint=(r=this.head)===null||r===void 0?void 0:r.endpoint}advance(e){const{chars:t,states:i,skippedStates:s,result:r}=this;let o=null,a=0;const l=i[i.length-1];function h(c,u){if(c.isMatch(e)&&(++a===1?o=c:r.add(new $t(t.concat(e),i.concat(c),u===null?s:s.concat(u),r))),l.segment===null&&c.isOptional&&c.nextStates!==null){if(c.nextStates.length>1)throw new Error(`${c.nextStates.length} nextStates`);const d=c.nextStates[0];if(!d.isSeparator)throw new Error("Not a separator");if(d.nextStates!==null)for(const f of d.nextStates)h(f,c)}}if(l.isDynamic&&h(l,null),l.nextStates!==null)for(const c of l.nextStates)h(c,null);o!==null&&(i.push(this.head=o),t.push(e),o.endpoint!==null&&(this.endpoint=o.endpoint)),a===0&&r.remove(this)}finalize(){function e(t,i){const s=i.nextStates;if(s!==null){if(s.length===1&&s[0].segment===null)e(t,s[0]);else for(const r of s)if(r.isOptional&&r.endpoint!==null){if(t.push(r),r.nextStates!==null)for(const o of r.nextStates)e(t,o);break}}}e(this.skippedStates,this.head)}getParams(){const{states:e,chars:t,endpoint:i}=this,s={};for(const r of i.paramNames)s[r]=void 0;for(let r=0,o=e.length;r<o;++r){const a=e[r];if(a.isDynamic){const l=a.segment.name;s[l]===void 0?s[l]=t[r]:s[l]+=t[r]}}return s}compareTo(e){const t=this.states,i=e.states;for(let l=0,h=0,c=Math.max(t.length,i.length);l<c;++l){let u=t[l];if(u===void 0)return 1;let d=i[h];if(d===void 0)return-1;let f=u.segment,v=d.segment;if(f===null){if(v===null){++h;continue}if((u=t[++l])===void 0)return 1;f=u.segment}else if(v===null){if((d=i[++h])===void 0)return-1;v=d.segment}if(f.kind<v.kind)return 1;if(f.kind>v.kind)return-1;++h}const s=this.skippedStates,r=e.skippedStates,o=s.length,a=r.length;if(o<a)return 1;if(o>a)return-1;for(let l=0;l<o;++l){const h=s[l],c=r[l];if(h.length<c.length)return 1;if(h.length>c.length)return-1}return 0}}function Es(n){return n.head.endpoint!==null}function js(n,e){return n.compareTo(e)}class xs{constructor(e){this.candidates=[],this.candidates=[new $t([""],[e],[],this)]}get isEmpty(){return this.candidates.length===0}getSolution(){const e=this.candidates.filter(Es);if(e.length===0)return null;for(const t of e)t.finalize();return e.sort(js),e[0]}add(e){this.candidates.push(e)}remove(e){this.candidates.splice(this.candidates.indexOf(e),1)}advance(e){const t=this.candidates.slice();for(const i of t)i.advance(e)}}class Rs{constructor(){this.names=new Map,this.paths=new Map,this.rootState=new Tt(null,null,"")}add(e,t){if(e instanceof Array)for(const i of e)this.$add(i,t);else this.$add(e,t)}$add(e,t){const i=e.path,s=new Ei(e.path,e.name||"",e.caseSensitive===!0),r=i===""?[""]:i.split("/").filter(As),o=[],a=[];let l=this.rootState;const h=[];for(const u of r)switch(l=l.append(null,"/"),u.charAt(0)){case"{":{const d=u.slice(1,-1).split(":").map(_=>_.trim());d.length===2?a.push(d[1]):a.push("string");const f=d[0].endsWith("?"),v=f?d[0].slice(0,-1):d[0];o.push(v);const b=new Qt(v,f);h.push(b),l=b.appendTo(l);break}case"*":{const d=u.slice(1);o.push(d),a.push("string");const f=new Is(d);h.push(f),l=f.appendTo(l);break}default:{const d=new Ps(u,s.caseSensitive);h.push(d),l=d.appendTo(l);break}}const c=new ji(s,o,a,t||null);l.setEndpoint(c),this.paths.set(i,h),e.name&&this.names.set(e.name,h)}recognize(e,t={}){return p(this,void 0,void 0,function*(){const i=le.separate(e),s=le.parse(i.queryString);e=decodeURI(i.path),e.startsWith("/")||(e=`/${e}`),e.length>1&&e.endsWith("/")&&(e=e.slice(0,-1));const r=new xs(this.rootState);for(let d=0,f=e.length;d<f;++d){const v=e.charAt(d);if(r.advance(v),r.isEmpty)return null}const o=r.getSolution();if(o===null)return null;const{endpoint:a}=o,l=a.paramNames,h=a.paramTypes,c=o.getParams(),u={};for(let d=0,f=l.length;d<f;++d){const v=l[d],b=t[h[d]]||ks,_=c[v],oe=yield b(_);u[v]=oe}return new xi(a,c,u,s)})}generateFromName(e,t){return this.generate(this.names.get(e),t)}generateFromPath(e,t){return this.generate(this.paths.get(e),t)}generate(e,t){if(!e)return null;const i=Object.assign({},t),s={};let r="";for(let a=0,l=e.length;a<l;a++){const h=e[a],c=h.generate(i,s);if(c==null){if(h instanceof Qt&&!h.optional)throw new Error(`A value is required for route parameter '${h.name}'.`)}else r+="/",r+=c}r.charAt(0)!=="/"&&(r="/"+r);for(const a in s)delete i[a];const o=le.build(i);return r+=o?`?${o}`:"",r}}class Tt{constructor(e,t,i){switch(this.prevState=e,this.segment=t,this.value=i,this.nextStates=null,this.endpoint=null,t==null?void 0:t.kind){case 2:this.length=e.length+1,this.isSeparator=!1,this.isDynamic=!0,this.isOptional=t.optional;break;case 1:this.length=e.length+1,this.isSeparator=!1,this.isDynamic=!0,this.isOptional=!1;break;case 3:this.length=e.length+1,this.isSeparator=!1,this.isDynamic=!1,this.isOptional=!1;break;case void 0:this.length=e===null?0:e.length,this.isSeparator=!0,this.isDynamic=!1,this.isOptional=!1;break}}append(e,t){let i,s=this.nextStates;return s===null?(i=void 0,s=this.nextStates=[]):e===null?i=s.find(r=>r.value===t):i=s.find(r=>{var o;return(o=r.segment)===null||o===void 0?void 0:o.equals(e)}),i===void 0&&s.push(i=new Tt(this,e,t)),i}setEndpoint(e){if(this.endpoint!==null)throw new Error(`Cannot add ambiguous route. The pattern '${e.route.path}' clashes with '${this.endpoint.route.path}'`);this.endpoint=e,this.isOptional&&(this.prevState.setEndpoint(e),this.prevState.isSeparator&&this.prevState.prevState!==null&&this.prevState.prevState.setEndpoint(e))}isMatch(e){const t=this.segment;switch(t==null?void 0:t.kind){case 2:return!this.value.includes(e);case 1:return!0;case 3:case void 0:return this.value.includes(e)}}}function As(n){return n.length>0}class Ps{constructor(e,t){this.value=e,this.caseSensitive=t}get kind(){return 3}appendTo(e){const{value:t,value:{length:i}}=this;if(this.caseSensitive)for(let s=0;s<i;++s)e=e.append(this,t.charAt(s));else for(let s=0;s<i;++s){const r=t.charAt(s);e=e.append(this,r.toUpperCase()+r.toLowerCase())}return e}generate(){return this.value}equals(e){return e.kind===3&&e.caseSensitive===this.caseSensitive&&e.value===this.value}}class Qt{constructor(e,t){this.name=e,this.optional=t}get kind(){return 2}appendTo(e){return e=e.append(this,"/"),e}generate(e,t){return t[this.name]=!0,e[this.name]}equals(e){return e.kind===2&&e.optional===this.optional&&e.name===this.name}}class Is{constructor(e){this.name=e}get kind(){return 1}appendTo(e){return e=e.append(this,""),e}generate(e,t){return t[this.name]=!0,e[this.name]}equals(e){return e.kind===1&&e.name===this.name}}const Ri="fast-child-route";function Kt(n,e){return"command"in e?e.command:"redirect"in e?new Di(e.redirect):Ne.fromDefinition(n,e)}const Yt=n=>{if(n==null)return!1;switch(n.toLowerCase().trim()){case"true":case"yes":case"1":return!0;default:return!1}},Ns={number:n=>n===void 0?NaN:parseFloat(n),float:n=>n===void 0?NaN:parseFloat(n),int:n=>n===void 0?NaN:parseInt(n),integer:n=>n===void 0?NaN:parseInt(n),Date:n=>n===void 0?new Date(Date.now()):new Date(n),boolean:Yt,bool:Yt};class Ds{constructor(e){this.owner=e,this._recognizer=null,this.pathToCommand=new Map,this.fallbackCommand=null,this.fallbackSettings=null,this.converters={}}get recognizer(){return this._recognizer===null&&(this._recognizer=this.owner.createRouteRecognizer()),this._recognizer}ignore(e){typeof e=="string"&&(e={path:e}),this.pathToCommand.set(e.path,new Hs),this.recognizer.add(e,e.settings)}map(...e){for(const t of e){if("children"in t){const s=this.owner.createTitleBuilder(),r=t.children.map(o=>{const a=Object.assign(Object.assign(Object.assign({},t),o),{path:`${t.path}/${o.path}`});if("title"in t||"title"in o){const l=t.title||"",h=o.title||"";a.title=s.joinTitles(l,h)}if("name"in o){const l=t.name?t.name+"/":"";a.name=l+o.name}return a.children===t.children&&delete a.children,a});this.map(...r);continue}let i;if("command"in t?i=t.command:"redirect"in t?i=new Di(t.redirect):i=Ne.fromDefinition(this.owner,t),this.pathToCommand.set(t.path,i),this.recognizer.add(t,t.settings),"childRouters"in t&&t.childRouters){const s=Object.assign(Object.assign({},t),{path:t.path+`/*${Ri}`});this.pathToCommand.set(s.path,i),this.recognizer.add(s,s.settings)}}}fallback(e){const t=this.owner;typeof e=="function"?this.fallbackCommand={createContributor(i,s){return p(this,void 0,void 0,function*(){const r=yield e();return Kt(t,r).createContributor(i,s)})}}:this.fallbackCommand=Kt(t,e)}converter(e,t){let i;"convert"in t?i=t.convert.bind(t):t.prototype&&"convert"in t.prototype?i=s=>this.owner.construct(t).convert(s):i=t,this.converters[e]=i}recognize(e){return p(this,void 0,void 0,function*(){const t=yield this.recognizer.recognize(e,this.aggregateConverters());if(t!==null)return{route:t,command:this.pathToCommand.get(t.endpoint.path)};if(this.fallbackCommand!==null){const i=le.separate(e),s=le.parse(i.queryString);return{route:new xi(new ji(new Ei("*","",!1),[],[],this.fallbackSettings),{},{},s),command:this.fallbackCommand}}return null})}generateFromName(e,t){return this.recognizer.generateFromName(e,t)}generateFromPath(e,t){return this.recognizer.generateFromPath(e,t)}aggregateConverters(){return this.owner.parent===null?Object.assign(Object.assign({},Ns),this.converters):Object.assign(Object.assign({},this.owner.parent.routes.aggregateConverters()),this.converters)}}const P="$router";function Ai(n){let e=n;for(;e=Cs(e);)if(P in e)return e[P];return null}const ue=Object.freeze({getOrCreateFor(n){const e=n[P];return e!==void 0?e:n[P]=new Ls(n)},find(n){return n[P]||Ai(n)},from(n){class e extends n{constructor(){super(),ue.getOrCreateFor(this)}get config(){return this[P].config}set config(s){this[P].config=s}}const t=e.prototype;if("connectedCallback"in t){const i=t.connectedCallback;t.connectedCallback=function(){i.call(this),this[P].connect()}}else t.connectedCallback=function(){this[P].connect()};if("disconnectedCallback"in t){const i=t.disconnectedCallback;t.disconnectedCallback=function(){i.call(this),this[P].disconnect()}}else t.disconnectedCallback=function(){this[P].disconnect()};return e}});function Bs(n){return n instanceof z}class Ls{constructor(e){this.host=e,this.parentRouter=void 0,this.contributors=new Set,this.navigationQueue=null,this.linkHandler=null,this.newView=null,this.newRoute=null,this.childCommandContributor=null,this.childRoute=null,this.isConnected=!1,this.routerConfig=null,this.view=null,this.route=null,this.onNavigationMessage=t=>p(this,void 0,void 0,function*(){yield this.config.createNavigationProcess().run(this,t),this.navigationQueue.receive().then(this.onNavigationMessage)}),e[P]=this}get config(){return this.routerConfig}set config(e){this.routerConfig=e,this.tryConnect()}get parent(){if(this.parentRouter===void 0){if(!this.isConnected)return null;this.parentRouter=Ai(this.host)}return this.parentRouter||null}get level(){return this.parent===null?0:this.parent.level+1}shouldRender(e){var t;if(this.route&&this.route.endpoint.path===e.endpoint.path){const i=e==null?void 0:e.allParams,s=(t=this.route)===null||t===void 0?void 0:t.allParams;if(JSON.stringify(s)===JSON.stringify(i))return!1}return!0}beginRender(e,t){return p(this,void 0,void 0,function*(){return this.newRoute=e,this.newView=yield t.createView(),this.newView.bind(e.allTypedParams,Us.create(this)),this.newView.appendTo(this.host),yield t.transition.begin(this.host,this.view,this.newView),{commit:this.renderOperationCommit.bind(this,t.layout,t.transition),rollback:this.renderOperationRollback.bind(this,t.transition)}})}connect(){this.isConnected=!0,this.tryConnect()}disconnect(){this.parent===null?(this.navigationQueue!==null&&(this.navigationQueue.disconnect(),this.navigationQueue=null),this.linkHandler!==null&&(this.linkHandler.disconnect(),this.linkHandler=null)):this.parent.removeContributor(this),this.isConnected=!1,this.parentRouter=void 0}addContributor(e){this.contributors.add(e)}removeContributor(e){this.contributors.delete(e)}tryConnect(){this.config===null||!this.isConnected||(this.parent===null?(this.navigationQueue!==null&&this.navigationQueue.disconnect(),this.navigationQueue=this.config.createNavigationQueue(),this.navigationQueue.connect(),this.navigationQueue.receive().then(this.onNavigationMessage),this.linkHandler!==null&&this.linkHandler.disconnect(),this.linkHandler=this.config.createLinkHandler(),this.linkHandler.connect()):(this.config.parent=this.parent.config,this.parent.addContributor(this)))}renderOperationCommit(e,t){return p(this,void 0,void 0,function*(){yield e.beforeCommit(this.host),yield t.commit(this.host,this.view,this.newView),yield e.afterCommit(this.host),this.view!==null&&this.view.dispose(),this.route=this.newRoute,this.view=this.newView,this.newRoute=null,this.newView=null})}renderOperationRollback(e){return p(this,void 0,void 0,function*(){this.newView!==null&&(yield e.rollback(this.host,this.view,this.newView),this.newView.dispose(),this.newRoute=null,this.newView=null)})}navigate(e){return p(this,void 0,void 0,function*(){yield this.tunnel(e)})}leave(e){return p(this,void 0,void 0,function*(){if(yield this.tunnel(e),!e.canceled){const t=this.contributors;this.contributors=new Set,e.onCancel(()=>this.contributors=t)}})}construct(e){return p(this,void 0,void 0,function*(){if(this.parent!==null){const t=e.route.allParams[Ri]||"",i=yield this.config.recognizeRoute(t);if(i===null){this.config.createEventSink().onUnhandledNavigationMessage(this,new je(t)),e.cancel();return}this.childRoute=i.route,this.childCommandContributor=yield i.command.createContributor(this,i.route)}yield this.tunnel(e)})}enter(e){return p(this,void 0,void 0,function*(){yield this.tunnel(e)})}commit(e){return p(this,void 0,void 0,function*(){yield this.tunnel(e)})}tunnel(e){return p(this,void 0,void 0,function*(){const t=this.childRoute,i=this.childCommandContributor;if(t&&i&&(yield e.evaluateContributor(i,t,this)),e.canceled)return;const s=[...this.config.findContributors(e.name),...Array.from(this.contributors)];for(const r of s)if(yield e.evaluateContributor(r,void 0,this),e.canceled)return})}}const Us=Object.freeze({create(n){return Object.create(T.default,{router:{value:n}})}}),Ms=Object.freeze({default:Object.freeze({begin(n,e,t){return p(this,void 0,void 0,function*(){})},rollback(n,e,t){return p(this,void 0,void 0,function*(){})},commit(n,e,t){return p(this,void 0,void 0,function*(){})}})});class Ot{constructor(e=null,t=null,i=!0){this.template=e,this.runBeforeCommit=i,this.styles=t==null?null:Array.isArray(t)?new x(t):t instanceof x?t:new x([t])}beforeCommit(e){return p(this,void 0,void 0,function*(){this.runBeforeCommit&&this.apply(e)})}afterCommit(e){return p(this,void 0,void 0,function*(){this.runBeforeCommit||this.apply(e)})}apply(e){Bs(e)&&(e.$fastController.template!==this.template&&(e.$fastController.template=this.template),e.$fastController.styles!==this.styles&&(e.$fastController.styles=this.styles))}}const zs=Object.freeze({default:new Ot(E`
            <slot></slot>
        `)});function Pi(n,e){return e in n}const Fs={lifecycle:!0,parameters:!0};class Ii{constructor(e){this.options=e}createHTML(e){return Pe.attribute(e(this))}createBehavior(e){return new Vs(e[this.nodeId],this.options)}}fe.define(Ii);class Vs{constructor(e,t){this.contributor=e,this.options=t,this.router=null}bind(e,t){if(this.options.lifecycle&&(this.router=t.router||ue.find(this.contributor),this.router.addContributor(this.contributor)),this.options.parameters){const i=this.contributor,s=e;for(const r in s)i[r]=s[r]}}unbind(e){this.router!==null&&this.router.removeContributor(this.contributor)}}function Ni(n){return new Ii(Object.assign({},Fs,n))}class Hs{createContributor(){return p(this,void 0,void 0,function*(){return{navigate(e){return p(this,void 0,void 0,function*(){e.cancel()})}}})}}class Di{constructor(e){this.redirect=e}createContributor(){return p(this,void 0,void 0,function*(){const e=this.redirect;return{navigate(t){return p(this,void 0,void 0,function*(){const i=t.router.config,s=(yield i.generateRouteFromName(e,t.route.allParams))||(yield i.generateRouteFromPath(e,t.route.allParams));if(s===null)throw new Error(`Invalid redirect. Name or path not found: ${e}`);t.cancel(()=>p(this,void 0,void 0,function*(){return I.path.replace(s)}))})}}})}}function ge(n){return E`<${n} ${Ni()}></${n}>`}function Xt(n){const e=document.createDocumentFragment();e.appendChild(n);const t=Ni();t.nodeId="h";const i=new gt(e,[t],{[t.nodeId]:n});return{create(){return i}}}class qs{constructor(e,t,i){this.router=e,this.route=t,this.command=i}construct(e){return p(this,void 0,void 0,function*(){if(!this.router.shouldRender(this.route)){e.cancel();return}this.operation=yield this.router.beginRender(this.route,this.command),e.onCancel(()=>this.operation.rollback())})}commit(e){return p(this,void 0,void 0,function*(){yield this.operation.commit(),this.command.title&&e.setTitle(this.command.title)})}}class Ne{constructor(e,t){this.owner=e,this.createView=t,this._layout=null,this._transition=null,this.title=""}get transition(){return this._transition||this.owner.defaultTransition}set transition(e){this._transition=e}get layout(){return this._layout||this.owner.defaultLayout}set layout(e){this._layout=e}createContributor(e,t){return p(this,void 0,void 0,function*(){return new qs(e,t,this)})}static fromDefinition(e,t){let i;"template"in t?i=()=>p(this,void 0,void 0,function*(){let r=t.template;return typeof r=="function"&&(r=yield r()),r.create()}):i=()=>p(this,void 0,void 0,function*(){let r=t.element,o=null;if(t.factory)o=t.factory;else if(typeof r=="function"){let a=ne.getByType(r);if(a)o=ge(a.name);else if(r=yield r(),typeof r=="string")o=ge(r);else if(r instanceof HTMLElement)o=Xt(r);else if(a=ne.getByType(r),a)o=ge(a.name);else throw new Error("Invalid value for element in route config.")}else r instanceof HTMLElement?t.factory=o=Xt(r):t.factory=o=ge(r);return o.create()});const s=new Ne(e,i);return t.layout&&(t.layout instanceof wi?s.layout=new Ot(t.layout):s.layout=t.layout),t.transition&&(s.transition=t.transition),t.title&&(s.title=t.title),s}}class Gs{constructor(){this.handler=e=>{const{shouldHandleEvent:t,href:i}=this.getEventInfo(e);t&&(e.preventDefault(),I.path.push(i))}}connect(){window.addEventListener("click",this.handler,!0)}disconnect(){window.removeEventListener("click",this.handler)}getEventInfo(e){const t={shouldHandleEvent:!1,href:null,anchor:null},i=this.findClosestAnchor(e);if(!i||!this.targetIsThisWindow(i)||i.hasAttribute("download")||i.hasAttribute("router-ignore")||i.hasAttribute("data-router-ignore")||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return t;const s=i.getAttribute("href");t.anchor=i,t.href=s;const r=e.which===1,o=s&&!(s.charAt(0)==="#"||/^[a-z]+:/i.test(s));return t.shouldHandleEvent=r&&!!o,t}findClosestAnchor(e){const t=e.composedPath();for(let i=0,s=t.length;i<s;++i){const r=t[i];if(r.tagName==="A")return r}return e.target}targetIsThisWindow(e){const t=e.getAttribute("target");return!t||t===window.name||t==="_self"}}class Js{constructor(e,t,i,s,r){this.name=e,this.commitActions=s,this.cancelActions=r,this.routes=[],this.routers=[],this.canceled=!1,this.titles=[],this.routes.push(t),this.routers.push(i)}get route(){return this.routes[this.routes.length-1]}get router(){return this.routers[this.routers.length-1]}cancel(e){this.canceled=!0,e&&this.cancelActions.push(e)}onCommit(e){this.commitActions.push(e)}onCancel(e){this.cancelActions.push(e)}setTitle(e){const t=this.router.level;for(;this.titles.length<t+1;)this.titles.push([]);this.titles[t].push(e)}evaluateContributor(e,t=this.route,i=this.router){return p(this,void 0,void 0,function*(){Pi(e,this.name)&&(this.routes.push(t),this.routers.push(i),yield e[this.name](this),this.routes.pop(),this.routers.pop())})}}class Ws{constructor(){this.phases=["navigate","leave","construct","enter","commit"]}run(e,t){return p(this,void 0,void 0,function*(){const i=e.config.createEventSink(),s=yield e.config.recognizeRoute(t.path);if(s===null){i.onUnhandledNavigationMessage(e,t);return}const r=s.route,o=s.command;i.onNavigationBegin(e,r,o);const a=[],l=[];let h=a;const c=[yield o.createContributor(e,r),e,this];for(const u of this.phases){const d=new Js(u,r,e,a,l);if(i.onPhaseBegin(d),d.canceled)h=l;else for(const f of c)if(yield d.evaluateContributor(f),d.canceled){h=l;break}if(i.onPhaseEnd(d),d.canceled)break}yield Promise.all(h.map(u=>u())).then(()=>i.onNavigationEnd(e,r,o))})}commit(e){const t=e.router.config.createTitleBuilder();document.title=t.buildTitle(e.router.config.title,e.titles)}}class Qs{constructor(e=" - ",t=":"){this.segmentSeparator=e,this.fragmentSeparator=t}joinTitles(e,t){return e===""?t:t===""?e:`${e}${this.segmentSeparator}${t}`}buildTitle(e,t){let i=e;for(const s of t){i&&(i=i+this.segmentSeparator);let r="";for(const o of s)r&&(r=r+this.fragmentSeparator),r=r+o;i=i+r}return i}}class Ks{onUnhandledNavigationMessage(e,t){}onNavigationBegin(e,t,i){}onPhaseBegin(e){}onPhaseEnd(e){}onNavigationEnd(e,t,i){}}class Ys{constructor(){this.isConfigured=!1,this.routes=new Ds(this),this.contributors=[],this.defaultLayout=zs.default,this.defaultTransition=Ms.default,this.title="",this.parent=null}createNavigationQueue(){return this.construct($s)}createLinkHandler(){return this.construct(Gs)}createNavigationProcess(){return new Ws}createEventSink(){return this.construct(Ks)}createTitleBuilder(){return this.construct(Qs)}createRouteRecognizer(){return this.construct(Rs)}construct(e){return this.parent!==null?this.parent.construct(e):new e}recognizeRoute(e){return p(this,void 0,void 0,function*(){return yield this.ensureConfigured(),this.routes.recognize(e)})}generateRouteFromName(e,t){return p(this,void 0,void 0,function*(){return yield this.ensureConfigured(),this.routes.generateFromName(e,t)})}generateRouteFromPath(e,t){return p(this,void 0,void 0,function*(){return yield this.ensureConfigured(),this.routes.generateFromPath(e,t)})}findContributors(e){return this.contributors.filter(t=>Pi(t,e))}cached(e){let t=null;return()=>p(this,void 0,void 0,function*(){return t===null&&(t=new e),t})}ensureConfigured(){return p(this,void 0,void 0,function*(){this.isConfigured||(yield this.configure(),this.isConfigured=!0)})}}let Zt=class extends ue.from(z){};Zt=Ss([A("fast-router")],Zt);const Xs=new Ot(E`
		<nav>
			<app-nav></app-nav>
		</nav>

		<main>
			<slot></slot>

			<app-stuff-selector></app-stuff-selector>
		</main>
	`,re`
		* {
			font-family: sans-serif;
		}

		:host {
			display: flex;
			width: 100%;
			height: 100%;
		}

		main {
			display: flex;
		}
	`);class Ye{static async getStuffLocalizationsByStuff(e){const t=await w.supabase.from("arrival").select().eq("mapId",e);if(t.error)return null;const i={smoke:{arrivals:[],departuresByArrivalId:{}},flash:{arrivals:[],departuresByArrivalId:{}},molotov:{arrivals:[],departuresByArrivalId:{}},grenade:{arrivals:[],departuresByArrivalId:{}}};let s=[];return t.data.forEach(r=>{s.push(w.supabase.from("departure").select().eq("arrivalId",r.id).then(o=>{o.error||o.data.forEach(a=>{i[a.stuff].arrivals.includes(r)||i[a.stuff].arrivals.push(r),i[a.stuff].departuresByArrivalId[r.id]||(i[a.stuff].departuresByArrivalId[r.id]=[]),i[a.stuff].departuresByArrivalId[r.id].push(a)})}))}),await Promise.all(s),i}static async createArrival(e,t,i){return w.supabase.from("arrival").insert([{x:e,y:t,mapId:i}])}static async createDeparture(e,t,i,s,r){return w.supabase.from("departure").insert([{arrivalId:e,x:t,y:i,stuff:s,videoUrl:r}])}}var Zs=Object.defineProperty,en=Object.getOwnPropertyDescriptor,q=(n,e,t,i)=>{for(var s=i>1?void 0:i?en(e,t):e,r=n.length-1,o;r>=0;r--)(o=n[r])&&(s=(i?o(e,t,s):o(s))||s);return i&&s&&Zs(e,t,s),s};let M=class extends z{constructor(){super(...arguments),this.arrivalIdSelected=null,this.videoUrl=null,this.editing=!1,this.arrivalCreation=null,this.arrivalEditionId=null,this.closeVideoWhenClickedOutside=n=>{n.path[0]!==this.videoElement&&(this.videoUrl=null,document.removeEventListener("click",this.closeVideoWhenClickedOutside))}}connectedCallback(){this.editing=w.editing,super.connectedCallback(),setTimeout(()=>{wt(w.editingReader,n=>{this.editing=n})})}disconnectedCallback(){w.setupNewStream(),super.disconnectedCallback()}handleClick(n){if(!this.editing)return;const e=Math.round(n.offsetX*1024/this.mapElement.offsetWidth)-10,t=Math.round(n.offsetY*1024/this.mapElement.offsetHeight)-10,i=n.path[0];i.className==="map"&&(this.arrivalEditionId?this.createDeparture(+this.arrivalEditionId,e,t):this.createArrivalAndDeparture(e,t)),i.className==="arrival"&&(this.arrivalEditionId=i.id)}async createArrivalAndDeparture(n,e){if(!this.arrivalCreation){this.arrivalCreation={x:n,y:e};return}const t=window.prompt("URL :");if(!t){this.arrivalCreation=null;return}const s=(await Ye.createArrival(this.arrivalCreation.x,this.arrivalCreation.y,this.mapId)).data[0];await this.createDeparture(s.id,n,e,t),this.arrivalCreation=null}async createDeparture(n,e,t,i=null){if(i||(i=window.prompt("URL :")),!i){this.arrivalEditionId=null;return}await Ye.createDeparture(n,e,t,this.stuff,i),this.arrivalEditionId=null}select(n){if(n===this.arrivalIdSelected){this.arrivalIdSelected=null;return}this.arrivalIdSelected=n}showStuff(n){this.videoUrl=n,setTimeout(()=>{document.addEventListener("click",this.closeVideoWhenClickedOutside)})}};q([pe()],M.prototype,"mapId",2);q([pe()],M.prototype,"mapUrl",2);q([pe()],M.prototype,"stuff",2);q([pe()],M.prototype,"stuffLocalizations",2);q([L],M.prototype,"arrivalIdSelected",2);q([L],M.prototype,"videoUrl",2);q([L],M.prototype,"editing",2);M=q([A({name:"app-map",styles:re`
		:host {
			display: flex;
		}

		*:focus {
			outline: none;
		}

		.map {
			width: 100vh;
			height: 100vh;
			position: relative;
			z-index: 0;
			background: 0 0% / contain no-repeat;
			margin: auto;
		}

		.arrival {
			position: absolute;
			border-radius: 50%;
			background: yellow;
			width: calc(20 / 1024 * 100%);
			height: calc(20 / 1024 * 100%);
			opacity: 0.75;
			cursor: pointer;
			border: none;
			padding: 0;
		}

		.arrival:hover,
		.arrival[aria-selected] {
			opacity: 1;
		}

		.departure {
			display: none;
			position: absolute;
			border-radius: 50%;
			background: red;
			width: calc(20 / 1024 * 100%);
			height: calc(20 / 1024 * 100%);
			cursor: pointer;
			border: none;
			padding: 0;
		}

		.arrival:hover + .departures-container .departure,
		.arrival:hover + .departures-container svg,
		.arrival[aria-selected] + .departures-container .departure,
		.arrival[aria-selected] + .departures-container svg {
			display: block;
		}

		svg {
			pointer-events: none;
			display: none;
			position: absolute;
			z-index: -1;
			width: auto;
			max-height: 100vh;
			max-width: 100vw;
			aspect-ratio: 1;
		}

		svg line {
			stroke: green;
			stroke-width: calc(2 / 1024 * 100%);
		}

		.video-container {
			position: absolute;
			top: calc(112 / 1024 * 100%);
			height: calc(800 / 1024 * 100%);
			width: 100vh;
			justify-content: center;
		}

		video {
			height: 100%;
			width: auto;
		}
	`,template:E`
		<div
			${Lt("mapElement")}
			@click="${(n,e)=>n.handleClick(e.event)}"
			class="map"
			style="background-image: url(${n=>n.mapUrl})"
		>
			${Te(n=>n.stuffLocalizations.arrivals,E`
					<button
						@click="${(n,e)=>e.parent.select(n.id)}"
						aria-selected="${(n,e)=>e.parent.arrivalIdSelected===n.id?"true":null}"
						class="arrival"
						id="${n=>n.id}"
						style="
							left: ${n=>`calc(${n.x} / 1024 * 100%)`};
							top: ${n=>`calc(${n.y} / 1024 * 100%)`};
						"
					></button>

					<div class="departures-container">
						${Te((n,e)=>e.parent.stuffLocalizations.departuresByArrivalId[n.id],E`
								<button
									class="departure"
									@click="${(n,e)=>e.parentContext.parent.showStuff(n.videoUrl)}"
									style="
											left: ${n=>`calc(${n.x} / 1024 * 100%)`};
											top: ${n=>`calc(${n.y} / 1024 * 100%)`};
										"
								></button>

								<svg viewBox="0 0 1024 1024">
									<line
										x1="${(n,e)=>e.parent.x+10}"
										y1="${(n,e)=>e.parent.y+10}"
										x2="${n=>n.x+10}"
										y2="${n=>n.y+10}"
									/>
								</svg>
							`)}
					</div>
				`)}
		</div>

		<div
			class="video-container"
			style="display: ${n=>n.videoUrl?"flex":"none"}"
		>
			<video
				${Lt("videoElement")}
				src="${n=>n.videoUrl}"
				autoplay
				loop
				muted
				controls
			></video>
		</div>
	`})],M);var tn="/csgo-helpers/assets/de_ancient.ea51c0de.png",sn="/csgo-helpers/assets/de_dust2.574d35c0.png",nn="/csgo-helpers/assets/de_inferno.3dc810f8.png",rn="/csgo-helpers/assets/de_mirage.996a7088.png",on="/csgo-helpers/assets/de_nuke.2327b3c2.png",an="/csgo-helpers/assets/de_overpass.c722b426.png",cn="/csgo-helpers/assets/de_vertigo.33bde87a.png",ln=Object.defineProperty,hn=Object.getOwnPropertyDescriptor,De=(n,e,t,i)=>{for(var s=i>1?void 0:i?hn(e,t):e,r=n.length-1,o;r>=0;r--)(o=n[r])&&(s=(i?o(e,t,s):o(s))||s);return i&&s&&ln(e,t,s),s};const Y=E`
	${Ci(n=>!!n.stuffLocalizations,E`
			<app-map
				:mapId="${n=>n.mapId}"
				:mapUrl="${n=>n.mapUrl}"
				:stuff="${n=>n.stuffActivated}"
				:stuffLocalizations="${n=>n.stuffLocalizations}"
			></app-map>
		`)}
`;class N extends z{constructor(){super(...arguments),this.stuffLocalizationsByStuff=null,this.stuffLocalizations=null,this.mapIdToMapUrl={1:tn,2:sn,3:nn,4:rn,5:on,6:an,7:cn}}connectedCallback(){this.mapUrl=this.mapIdToMapUrl[this.mapId],Ye.getStuffLocalizationsByStuff(this.mapId).then(e=>{this.stuffLocalizationsByStuff=e,this.stuffLocalizationsByStuff&&(this.stuffLocalizations=this.stuffLocalizationsByStuff[$.stuffActivated])}),this.stuffActivated=$.stuffActivated,super.connectedCallback(),setTimeout(()=>{wt($.stuffActivatedReader,e=>{var t,i;this.stuffActivated=$.stuffActivated,this.stuffLocalizations=(i=(t=this.stuffLocalizationsByStuff)==null?void 0:t[e])!=null?i:null})})}disconnectedCallback(){$.setupNewStream(),super.disconnectedCallback()}}De([L],N.prototype,"stuffLocalizationsByStuff",2);De([L],N.prototype,"stuffActivated",2);De([L],N.prototype,"stuffLocalizations",2);De([L],N.prototype,"mapUrl",2);var un=Object.defineProperty,dn=Object.getOwnPropertyDescriptor,fn=(n,e,t,i)=>{for(var s=i>1?void 0:i?dn(e,t):e,r=n.length-1,o;r>=0;r--)(o=n[r])&&(s=(i?o(e,t,s):o(s))||s);return i&&s&&un(e,t,s),s};let Xe=class extends N{constructor(){super(...arguments),this.mapId=1}};Xe=fn([A({name:"app-de-ancient-page",template:Y})],Xe);var pn=Object.defineProperty,vn=Object.getOwnPropertyDescriptor,mn=(n,e,t,i)=>{for(var s=i>1?void 0:i?vn(e,t):e,r=n.length-1,o;r>=0;r--)(o=n[r])&&(s=(i?o(e,t,s):o(s))||s);return i&&s&&pn(e,t,s),s};let Ze=class extends N{constructor(){super(...arguments),this.mapId=2}};Ze=mn([A({name:"app-de-dust2-page",template:Y})],Ze);var gn=Object.defineProperty,bn=Object.getOwnPropertyDescriptor,yn=(n,e,t,i)=>{for(var s=i>1?void 0:i?bn(e,t):e,r=n.length-1,o;r>=0;r--)(o=n[r])&&(s=(i?o(e,t,s):o(s))||s);return i&&s&&gn(e,t,s),s};let et=class extends N{constructor(){super(...arguments),this.mapId=3}};et=yn([A({name:"app-de-inferno-page",template:Y})],et);var wn=Object.defineProperty,_n=Object.getOwnPropertyDescriptor,Sn=(n,e,t,i)=>{for(var s=i>1?void 0:i?_n(e,t):e,r=n.length-1,o;r>=0;r--)(o=n[r])&&(s=(i?o(e,t,s):o(s))||s);return i&&s&&wn(e,t,s),s};let tt=class extends N{constructor(){super(...arguments),this.mapId=4}};tt=Sn([A({name:"app-de-mirage-page",template:Y})],tt);var Cn=Object.defineProperty,$n=Object.getOwnPropertyDescriptor,Tn=(n,e,t,i)=>{for(var s=i>1?void 0:i?$n(e,t):e,r=n.length-1,o;r>=0;r--)(o=n[r])&&(s=(i?o(e,t,s):o(s))||s);return i&&s&&Cn(e,t,s),s};let it=class extends N{constructor(){super(...arguments),this.mapId=5}};it=Tn([A({name:"app-de-nuke-page",template:Y})],it);var On=Object.defineProperty,kn=Object.getOwnPropertyDescriptor,En=(n,e,t,i)=>{for(var s=i>1?void 0:i?kn(e,t):e,r=n.length-1,o;r>=0;r--)(o=n[r])&&(s=(i?o(e,t,s):o(s))||s);return i&&s&&On(e,t,s),s};let st=class extends N{constructor(){super(...arguments),this.mapId=6}};st=En([A({name:"app-de-overpass-page",template:Y})],st);var jn=Object.defineProperty,xn=Object.getOwnPropertyDescriptor,Rn=(n,e,t,i)=>{for(var s=i>1?void 0:i?xn(e,t):e,r=n.length-1,o;r>=0;r--)(o=n[r])&&(s=(i?o(e,t,s):o(s))||s);return i&&s&&jn(e,t,s),s};let nt=class extends N{constructor(){super(...arguments),this.mapId=7}};nt=Rn([A({name:"app-de-vertigo-page",template:Y})],nt);var An=Object.defineProperty,Pn=Object.getOwnPropertyDescriptor,Bi=(n,e,t,i)=>{for(var s=i>1?void 0:i?Pn(e,t):e,r=n.length-1,o;r>=0;r--)(o=n[r])&&(s=(i?o(e,t,s):o(s))||s);return i&&s&&An(e,t,s),s};let xe=class extends z{constructor(){super(...arguments),this.email=""}login(){try{w.supabase.auth.signIn({email:this.email},{shouldCreateUser:!1}),alert("Check your email for the login link!")}catch(n){console.error(n)}}};Bi([L],xe.prototype,"email",2);xe=Bi([A({name:"app-login-page",template:E`
		<input
			:value="${K(n=>n.email,ki)}"
			type="text"
			placeholder="Email"
		/>

		<button @click="${n=>n.login()}">Login</button>
	`})],xe);class In extends Ys{configure(){this.title="CS:GO Helpers",this.defaultLayout=Xs,this.routes.map({path:"csgo-helpers",children:[{path:"login",title:"Login",element:xe},{path:"de_dust2",title:"de_dust2",element:Ze},{path:"de_nuke",title:"de_nuke",element:it},{path:"de_vertigo",title:"de_vertigo",element:nt},{path:"de_overpass",title:"de_overpass",element:st},{path:"de_inferno",title:"de_inferno",element:et},{path:"de_mirage",title:"de_mirage",element:tt},{path:"de_ancient",title:"de_ancient",element:Xe}]}),this.routes.fallback({redirect:"csgo-helpers/de_dust2"})}createEventSink(){return this.construct(St)}}const Nn="1.35.4",Li={"X-Client-Info":`supabase-js/${Nn}`},Dn="supabase.auth.token";function Bn(n){return n.replace(/\/$/,"")}const Ln=()=>typeof window!="undefined",Un="1.22.18",Mn="http://localhost:9999",zn={"X-Client-Info":`gotrue-js/${Un}`},be=10,G={ERROR_MESSAGE:"Request Failed",MAX_RETRIES:10,RETRY_INTERVAL:2},ae="supabase.auth.token",Fn={name:"sb",lifetime:60*60*8,domain:"",path:"/",sameSite:"lax"};var ve=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(c){try{h(i.next(c))}catch(u){o(u)}}function l(c){try{h(i.throw(c))}catch(u){o(u)}}function h(c){c.done?r(c.value):s(c.value).then(a,l)}h((i=i.apply(n,e||[])).next())})};const Vn=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Hn=(n,e)=>{if(!(n!=null&&n.status))return e({message:G.ERROR_MESSAGE});if(typeof n.json!="function")return e(n);n.json().then(t=>e({message:Vn(t),status:(n==null?void 0:n.status)||500}))},qn=(n,e,t)=>{const i={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"||(i.headers=Object.assign({"Content-Type":"text/plain;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(t)),i};function Be(n,e,t,i,s){return ve(this,void 0,void 0,function*(){return new Promise((r,o)=>{n(t,qn(e,i,s)).then(a=>{if(!a.ok)throw a;return i!=null&&i.noResolveJson?r:a.json()}).then(a=>r(a)).catch(a=>Hn(a,o))})})}function Ge(n,e,t){return ve(this,void 0,void 0,function*(){return Be(n,"GET",e,t)})}function O(n,e,t,i){return ve(this,void 0,void 0,function*(){return Be(n,"POST",e,i,t)})}function ei(n,e,t,i){return ve(this,void 0,void 0,function*(){return Be(n,"PUT",e,i,t)})}function Gn(n,e,t,i){return ve(this,void 0,void 0,function*(){return Be(n,"DELETE",e,i,t)})}function Jn(n,e,t){const i=t||{},s=encodeURIComponent,r=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;if(typeof s!="function")throw new TypeError("option encode is invalid");if(!r.test(n))throw new TypeError("argument name is invalid");const o=s(e);if(o&&!r.test(o))throw new TypeError("argument val is invalid");let a=n+"="+o;if(i.maxAge!=null){const l=i.maxAge-0;if(isNaN(l)||!isFinite(l))throw new TypeError("option maxAge is invalid");a+="; Max-Age="+Math.floor(l)}if(i.domain){if(!r.test(i.domain))throw new TypeError("option domain is invalid");a+="; Domain="+i.domain}if(i.path){if(!r.test(i.path))throw new TypeError("option path is invalid");a+="; Path="+i.path}if(i.expires){if(typeof i.expires.toUTCString!="function")throw new TypeError("option expires is invalid");a+="; Expires="+i.expires.toUTCString()}if(i.httpOnly&&(a+="; HttpOnly"),i.secure&&(a+="; Secure"),i.sameSite)switch(typeof i.sameSite=="string"?i.sameSite.toLowerCase():i.sameSite){case"lax":a+="; SameSite=Lax";break;case"strict":a+="; SameSite=Strict";break;case"none":a+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return a}function Wn(n){if(!n||!n.headers||!n.headers.host)throw new Error('The "host" request header is not available');const e=n.headers.host.indexOf(":")>-1&&n.headers.host.split(":")[0]||n.headers.host;return!(["localhost","127.0.0.1"].indexOf(e)>-1||e.endsWith(".local"))}function Qn(n,e){var t,i,s;return Jn(n.name,n.value,{maxAge:n.maxAge,expires:new Date(Date.now()+n.maxAge*1e3),httpOnly:!0,secure:e,path:(t=n.path)!==null&&t!==void 0?t:"/",domain:(i=n.domain)!==null&&i!==void 0?i:"",sameSite:(s=n.sameSite)!==null&&s!==void 0?s:"lax"})}function rt(n,e,t){const i=t.map(r=>Qn(r,Wn(n))),s=e.getHeader("Set-Cookie");return s&&(s instanceof Array?Array.prototype.push.apply(i,s):typeof s=="string"&&i.push(s)),i}function ye(n,e,t){e.setHeader("Set-Cookie",rt(n,e,t))}const Kn="modulepreload",ti={},Yn="/csgo-helpers/",Le=function(e,t){return!t||t.length===0?e():Promise.all(t.map(i=>{if(i=`${Yn}${i}`,i in ti)return;ti[i]=!0;const s=i.endsWith(".css"),r=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${r}`))return;const o=document.createElement("link");if(o.rel=s?"stylesheet":Kn,s||(o.as="script",o.crossOrigin=""),o.href=i,document.head.appendChild(o),s)return new Promise((a,l)=>{o.addEventListener("load",a),o.addEventListener("error",()=>l(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e())};var Ue=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(c){try{h(i.next(c))}catch(u){o(u)}}function l(c){try{h(i.throw(c))}catch(u){o(u)}}function h(c){c.done?r(c.value):s(c.value).then(a,l)}h((i=i.apply(n,e||[])).next())})};function F(n){return Math.round(Date.now()/1e3)+n}function Xn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const U=()=>typeof window!="undefined";function V(n,e){var t;e||(e=((t=window==null?void 0:window.location)===null||t===void 0?void 0:t.href)||""),n=n.replace(/[\[\]]/g,"\\$&");const i=new RegExp("[?&#]"+n+"(=([^&#]*)|&|#|$)"),s=i.exec(e);return s?s[2]?decodeURIComponent(s[2].replace(/\+/g," ")):"":null}const Zn=n=>{let e;return n?e=n:typeof fetch=="undefined"?e=(...t)=>Ue(void 0,void 0,void 0,function*(){return yield(yield Le(()=>import("./browser-ponyfill.34bdb024.js").then(function(i){return i.b}),[])).fetch(...t)}):e=fetch,(...t)=>e(...t)},er=(n,e,t)=>Ue(void 0,void 0,void 0,function*(){U()&&(yield n==null?void 0:n.setItem(e,JSON.stringify(t)))}),tr=(n,e)=>Ue(void 0,void 0,void 0,function*(){const t=U()&&(yield n==null?void 0:n.getItem(e));if(!t)return null;try{return JSON.parse(t)}catch{return t}}),ir=(n,e)=>{const t=U()&&(n==null?void 0:n.getItem(e));if(!t||typeof t!="string")return null;try{return JSON.parse(t)}catch{return t}},sr=(n,e)=>Ue(void 0,void 0,void 0,function*(){U()&&(yield n==null?void 0:n.removeItem(e))});var y=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(c){try{h(i.next(c))}catch(u){o(u)}}function l(c){try{h(i.throw(c))}catch(u){o(u)}}function h(c){c.done?r(c.value):s(c.value).then(a,l)}h((i=i.apply(n,e||[])).next())})};class nr{constructor({url:e="",headers:t={},cookieOptions:i,fetch:s}){this.url=e,this.headers=t,this.cookieOptions=Object.assign(Object.assign({},Fn),i),this.fetch=Zn(s)}_createRequestHeaders(e){const t=Object.assign({},this.headers);return t.Authorization=`Bearer ${e}`,t}cookieName(){var e;return(e=this.cookieOptions.name)!==null&&e!==void 0?e:""}getUrlForProvider(e,t){const i=[`provider=${encodeURIComponent(e)}`];if(t!=null&&t.redirectTo&&i.push(`redirect_to=${encodeURIComponent(t.redirectTo)}`),t!=null&&t.scopes&&i.push(`scopes=${encodeURIComponent(t.scopes)}`),t!=null&&t.queryParams){const s=new URLSearchParams(t.queryParams);i.push(`${s}`)}return`${this.url}/authorize?${i.join("&")}`}signUpWithEmail(e,t,i={}){return y(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let r="";i.redirectTo&&(r="?redirect_to="+encodeURIComponent(i.redirectTo));const o=yield O(this.fetch,`${this.url}/signup${r}`,{email:e,password:t,data:i.data,gotrue_meta_security:{captcha_token:i.captchaToken}},{headers:s}),a=Object.assign({},o);return a.expires_in&&(a.expires_at=F(o.expires_in)),{data:a,error:null}}catch(s){return{data:null,error:s}}})}signInWithEmail(e,t,i={}){return y(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let r="?grant_type=password";i.redirectTo&&(r+="&redirect_to="+encodeURIComponent(i.redirectTo));const o=yield O(this.fetch,`${this.url}/token${r}`,{email:e,password:t},{headers:s}),a=Object.assign({},o);return a.expires_in&&(a.expires_at=F(o.expires_in)),{data:a,error:null}}catch(s){return{data:null,error:s}}})}signUpWithPhone(e,t,i={}){return y(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers),r=yield O(this.fetch,`${this.url}/signup`,{phone:e,password:t,data:i.data,gotrue_meta_security:{captcha_token:i.captchaToken}},{headers:s}),o=Object.assign({},r);return o.expires_in&&(o.expires_at=F(r.expires_in)),{data:o,error:null}}catch(s){return{data:null,error:s}}})}signInWithPhone(e,t){return y(this,void 0,void 0,function*(){try{const i=Object.assign({},this.headers),s="?grant_type=password",r=yield O(this.fetch,`${this.url}/token${s}`,{phone:e,password:t},{headers:i}),o=Object.assign({},r);return o.expires_in&&(o.expires_at=F(r.expires_in)),{data:o,error:null}}catch(i){return{data:null,error:i}}})}signInWithOpenIDConnect({id_token:e,nonce:t,client_id:i,issuer:s,provider:r}){return y(this,void 0,void 0,function*(){try{const o=Object.assign({},this.headers),a="?grant_type=id_token",l=yield O(this.fetch,`${this.url}/token${a}`,{id_token:e,nonce:t,client_id:i,issuer:s,provider:r},{headers:o}),h=Object.assign({},l);return h.expires_in&&(h.expires_at=F(l.expires_in)),{data:h,error:null}}catch(o){return{data:null,error:o}}})}sendMagicLinkEmail(e,t={}){var i;return y(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let r="";t.redirectTo&&(r+="?redirect_to="+encodeURIComponent(t.redirectTo));const o=(i=t.shouldCreateUser)!==null&&i!==void 0?i:!0;return{data:yield O(this.fetch,`${this.url}/otp${r}`,{email:e,create_user:o,gotrue_meta_security:{captcha_token:t.captchaToken}},{headers:s}),error:null}}catch(s){return{data:null,error:s}}})}sendMobileOTP(e,t={}){var i;return y(this,void 0,void 0,function*(){try{const s=(i=t.shouldCreateUser)!==null&&i!==void 0?i:!0,r=Object.assign({},this.headers);return{data:yield O(this.fetch,`${this.url}/otp`,{phone:e,create_user:s,gotrue_meta_security:{captcha_token:t.captchaToken}},{headers:r}),error:null}}catch(s){return{data:null,error:s}}})}signOut(e){return y(this,void 0,void 0,function*(){try{return yield O(this.fetch,`${this.url}/logout`,{},{headers:this._createRequestHeaders(e),noResolveJson:!0}),{error:null}}catch(t){return{error:t}}})}verifyMobileOTP(e,t,i={}){return y(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers),r=yield O(this.fetch,`${this.url}/verify`,{phone:e,token:t,type:"sms",redirect_to:i.redirectTo},{headers:s}),o=Object.assign({},r);return o.expires_in&&(o.expires_at=F(r.expires_in)),{data:o,error:null}}catch(s){return{data:null,error:s}}})}verifyOTP({email:e,phone:t,token:i,type:s="sms"},r={}){return y(this,void 0,void 0,function*(){try{const o=Object.assign({},this.headers),a=yield O(this.fetch,`${this.url}/verify`,{email:e,phone:t,token:i,type:s,redirect_to:r.redirectTo},{headers:o}),l=Object.assign({},a);return l.expires_in&&(l.expires_at=F(a.expires_in)),{data:l,error:null}}catch(o){return{data:null,error:o}}})}inviteUserByEmail(e,t={}){return y(this,void 0,void 0,function*(){try{const i=Object.assign({},this.headers);let s="";return t.redirectTo&&(s+="?redirect_to="+encodeURIComponent(t.redirectTo)),{data:yield O(this.fetch,`${this.url}/invite${s}`,{email:e,data:t.data},{headers:i}),error:null}}catch(i){return{data:null,error:i}}})}resetPasswordForEmail(e,t={}){return y(this,void 0,void 0,function*(){try{const i=Object.assign({},this.headers);let s="";return t.redirectTo&&(s+="?redirect_to="+encodeURIComponent(t.redirectTo)),{data:yield O(this.fetch,`${this.url}/recover${s}`,{email:e,gotrue_meta_security:{captcha_token:t.captchaToken}},{headers:i}),error:null}}catch(i){return{data:null,error:i}}})}refreshAccessToken(e){return y(this,void 0,void 0,function*(){try{const t=yield O(this.fetch,`${this.url}/token?grant_type=refresh_token`,{refresh_token:e},{headers:this.headers}),i=Object.assign({},t);return i.expires_in&&(i.expires_at=F(t.expires_in)),{data:i,error:null}}catch(t){return{data:null,error:t}}})}setAuthCookie(e,t){e.method!=="POST"&&(t.setHeader("Allow","POST"),t.status(405).end("Method Not Allowed"));const{event:i,session:s}=e.body;if(!i)throw new Error("Auth event missing!");if(i==="SIGNED_IN"){if(!s)throw new Error("Auth session missing!");ye(e,t,[{key:"access-token",value:s.access_token},{key:"refresh-token",value:s.refresh_token}].map(r=>{var o;return{name:`${this.cookieName()}-${r.key}`,value:r.value,domain:this.cookieOptions.domain,maxAge:(o=this.cookieOptions.lifetime)!==null&&o!==void 0?o:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}}))}i==="SIGNED_OUT"&&ye(e,t,["access-token","refresh-token"].map(r=>({name:`${this.cookieName()}-${r}`,value:"",maxAge:-1}))),t.status(200).json({})}deleteAuthCookie(e,t,{redirectTo:i="/"}){return ye(e,t,["access-token","refresh-token"].map(s=>({name:`${this.cookieName()}-${s}`,value:"",maxAge:-1}))),t.redirect(307,i)}getAuthCookieString(e,t){e.method!=="POST"&&(t.setHeader("Allow","POST"),t.status(405).end("Method Not Allowed"));const{event:i,session:s}=e.body;if(!i)throw new Error("Auth event missing!");if(i==="SIGNED_IN"){if(!s)throw new Error("Auth session missing!");return rt(e,t,[{key:"access-token",value:s.access_token},{key:"refresh-token",value:s.refresh_token}].map(r=>{var o;return{name:`${this.cookieName()}-${r.key}`,value:r.value,domain:this.cookieOptions.domain,maxAge:(o=this.cookieOptions.lifetime)!==null&&o!==void 0?o:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}}))}return i==="SIGNED_OUT"?rt(e,t,["access-token","refresh-token"].map(r=>({name:`${this.cookieName()}-${r}`,value:"",maxAge:-1}))):t.getHeader("Set-Cookie")}generateLink(e,t,i={}){return y(this,void 0,void 0,function*(){try{return{data:yield O(this.fetch,`${this.url}/admin/generate_link`,{type:e,email:t,password:i.password,data:i.data,redirect_to:i.redirectTo},{headers:this.headers}),error:null}}catch(s){return{data:null,error:s}}})}createUser(e){return y(this,void 0,void 0,function*(){try{const t=yield O(this.fetch,`${this.url}/admin/users`,e,{headers:this.headers});return{user:t,data:t,error:null}}catch(t){return{user:null,data:null,error:t}}})}listUsers(){return y(this,void 0,void 0,function*(){try{return{data:(yield Ge(this.fetch,`${this.url}/admin/users`,{headers:this.headers})).users,error:null}}catch(e){return{data:null,error:e}}})}getUserById(e){return y(this,void 0,void 0,function*(){try{return{data:yield Ge(this.fetch,`${this.url}/admin/users/${e}`,{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}getUserByCookie(e,t){return y(this,void 0,void 0,function*(){try{if(!e.cookies)throw new Error("Not able to parse cookies! When using Express make sure the cookie-parser middleware is in use!");const i=e.cookies[`${this.cookieName()}-access-token`],s=e.cookies[`${this.cookieName()}-refresh-token`];if(!i)throw new Error("No cookie found!");const{user:r,error:o}=yield this.getUser(i);if(o){if(!s)throw new Error("No refresh_token cookie found!");if(!t)throw new Error("You need to pass the res object to automatically refresh the session!");const{data:a,error:l}=yield this.refreshAccessToken(s);if(l)throw l;if(a)return ye(e,t,[{key:"access-token",value:a.access_token},{key:"refresh-token",value:a.refresh_token}].map(h=>{var c;return{name:`${this.cookieName()}-${h.key}`,value:h.value,domain:this.cookieOptions.domain,maxAge:(c=this.cookieOptions.lifetime)!==null&&c!==void 0?c:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}})),{token:a.access_token,user:a.user,data:a.user,error:null}}return{token:i,user:r,data:r,error:null}}catch(i){return{token:null,user:null,data:null,error:i}}})}updateUserById(e,t){return y(this,void 0,void 0,function*(){try{const i=yield ei(this.fetch,`${this.url}/admin/users/${e}`,t,{headers:this.headers});return{user:i,data:i,error:null}}catch(i){return{user:null,data:null,error:i}}})}deleteUser(e){return y(this,void 0,void 0,function*(){try{const t=yield Gn(this.fetch,`${this.url}/admin/users/${e}`,{},{headers:this.headers});return{user:t,data:t,error:null}}catch(t){return{user:null,data:null,error:t}}})}getUser(e){return y(this,void 0,void 0,function*(){try{const t=yield Ge(this.fetch,`${this.url}/user`,{headers:this._createRequestHeaders(e)});return{user:t,data:t,error:null}}catch(t){return{user:null,data:null,error:t}}})}updateUser(e,t){return y(this,void 0,void 0,function*(){try{const i=yield ei(this.fetch,`${this.url}/user`,t,{headers:this._createRequestHeaders(e)});return{user:i,data:i,error:null}}catch(i){return{user:null,data:null,error:i}}})}}function rr(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self!="undefined"&&(self.globalThis=self)}}var k=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(c){try{h(i.next(c))}catch(u){o(u)}}function l(c){try{h(i.throw(c))}catch(u){o(u)}}function h(c){c.done?r(c.value):s(c.value).then(a,l)}h((i=i.apply(n,e||[])).next())})};rr();const or={url:Mn,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,multiTab:!0,headers:zn};class ar{constructor(e){this.stateChangeEmitters=new Map,this.networkRetries=0;const t=Object.assign(Object.assign({},or),e);this.currentUser=null,this.currentSession=null,this.autoRefreshToken=t.autoRefreshToken,this.persistSession=t.persistSession,this.multiTab=t.multiTab,this.localStorage=t.localStorage||globalThis.localStorage,this.api=new nr({url:t.url,headers:t.headers,cookieOptions:t.cookieOptions,fetch:t.fetch}),this._recoverSession(),this._recoverAndRefresh(),this._listenForMultiTabEvents(),this._handleVisibilityChange(),t.detectSessionInUrl&&U()&&!!V("access_token")&&this.getSessionFromUrl({storeSession:!0}).then(({error:i})=>{i&&console.error("Error getting session from URL.",i)})}signUp({email:e,password:t,phone:i},s={}){return k(this,void 0,void 0,function*(){try{this._removeSession();const{data:r,error:o}=i&&t?yield this.api.signUpWithPhone(i,t,{data:s.data,captchaToken:s.captchaToken}):yield this.api.signUpWithEmail(e,t,{redirectTo:s.redirectTo,data:s.data,captchaToken:s.captchaToken});if(o)throw o;if(!r)throw"An error occurred on sign up.";let a=null,l=null;return r.access_token&&(a=r,l=a.user,this._saveSession(a),this._notifyAllSubscribers("SIGNED_IN")),r.id&&(l=r),{user:l,session:a,error:null}}catch(r){return{user:null,session:null,error:r}}})}signIn({email:e,phone:t,password:i,refreshToken:s,provider:r,oidc:o},a={}){return k(this,void 0,void 0,function*(){try{if(this._removeSession(),e&&!i){const{error:l}=yield this.api.sendMagicLinkEmail(e,{redirectTo:a.redirectTo,shouldCreateUser:a.shouldCreateUser,captchaToken:a.captchaToken});return{user:null,session:null,error:l}}if(e&&i)return this._handleEmailSignIn(e,i,{redirectTo:a.redirectTo});if(t&&!i){const{error:l}=yield this.api.sendMobileOTP(t,{shouldCreateUser:a.shouldCreateUser,captchaToken:a.captchaToken});return{user:null,session:null,error:l}}if(t&&i)return this._handlePhoneSignIn(t,i);if(s){const{error:l}=yield this._callRefreshToken(s);if(l)throw l;return{user:this.currentUser,session:this.currentSession,error:null}}if(r)return this._handleProviderSignIn(r,{redirectTo:a.redirectTo,scopes:a.scopes,queryParams:a.queryParams});if(o)return this._handleOpenIDConnectSignIn(o);throw new Error("You must provide either an email, phone number, a third-party provider or OpenID Connect.")}catch(l){return{user:null,session:null,error:l}}})}verifyOTP(e,t={}){return k(this,void 0,void 0,function*(){try{this._removeSession();const{data:i,error:s}=yield this.api.verifyOTP(e,t);if(s)throw s;if(!i)throw"An error occurred on token verification.";let r=null,o=null;return i.access_token&&(r=i,o=r.user,this._saveSession(r),this._notifyAllSubscribers("SIGNED_IN")),i.id&&(o=i),{user:o,session:r,error:null}}catch(i){return{user:null,session:null,error:i}}})}user(){return this.currentUser}session(){return this.currentSession}refreshSession(){var e;return k(this,void 0,void 0,function*(){try{if(!(!((e=this.currentSession)===null||e===void 0)&&e.access_token))throw new Error("Not logged in.");const{error:t}=yield this._callRefreshToken();if(t)throw t;return{data:this.currentSession,user:this.currentUser,error:null}}catch(t){return{data:null,user:null,error:t}}})}update(e){var t;return k(this,void 0,void 0,function*(){try{if(!(!((t=this.currentSession)===null||t===void 0)&&t.access_token))throw new Error("Not logged in.");const{user:i,error:s}=yield this.api.updateUser(this.currentSession.access_token,e);if(s)throw s;if(!i)throw Error("Invalid user data.");const r=Object.assign(Object.assign({},this.currentSession),{user:i});return this._saveSession(r),this._notifyAllSubscribers("USER_UPDATED"),{data:i,user:i,error:null}}catch(i){return{data:null,user:null,error:i}}})}setSession(e){return k(this,void 0,void 0,function*(){try{if(!e)throw new Error("No current session.");const{data:t,error:i}=yield this.api.refreshAccessToken(e);return i?{session:null,error:i}:(this._saveSession(t),this._notifyAllSubscribers("SIGNED_IN"),{session:t,error:null})}catch(t){return{error:t,session:null}}})}setAuth(e){return this.currentSession=Object.assign(Object.assign({},this.currentSession),{access_token:e,token_type:"bearer",user:this.user()}),this._notifyAllSubscribers("TOKEN_REFRESHED"),this.currentSession}getSessionFromUrl(e){return k(this,void 0,void 0,function*(){try{if(!U())throw new Error("No browser detected.");const t=V("error_description");if(t)throw new Error(t);const i=V("provider_token"),s=V("access_token");if(!s)throw new Error("No access_token detected.");const r=V("expires_in");if(!r)throw new Error("No expires_in detected.");const o=V("refresh_token");if(!o)throw new Error("No refresh_token detected.");const a=V("token_type");if(!a)throw new Error("No token_type detected.");const h=Math.round(Date.now()/1e3)+parseInt(r),{user:c,error:u}=yield this.api.getUser(s);if(u)throw u;const d={provider_token:i,access_token:s,expires_in:parseInt(r),expires_at:h,refresh_token:o,token_type:a,user:c};if(e!=null&&e.storeSession){this._saveSession(d);const f=V("type");this._notifyAllSubscribers("SIGNED_IN"),f==="recovery"&&this._notifyAllSubscribers("PASSWORD_RECOVERY")}return window.location.hash="",{data:d,error:null}}catch(t){return{data:null,error:t}}})}signOut(){var e;return k(this,void 0,void 0,function*(){const t=(e=this.currentSession)===null||e===void 0?void 0:e.access_token;if(this._removeSession(),this._notifyAllSubscribers("SIGNED_OUT"),t){const{error:i}=yield this.api.signOut(t);if(i)return{error:i}}return{error:null}})}onAuthStateChange(e){try{const t=Xn(),i={id:t,callback:e,unsubscribe:()=>{this.stateChangeEmitters.delete(t)}};return this.stateChangeEmitters.set(t,i),{data:i,error:null}}catch(t){return{data:null,error:t}}}_handleEmailSignIn(e,t,i={}){var s,r;return k(this,void 0,void 0,function*(){try{const{data:o,error:a}=yield this.api.signInWithEmail(e,t,{redirectTo:i.redirectTo});return a||!o?{data:null,user:null,session:null,error:a}:((((s=o==null?void 0:o.user)===null||s===void 0?void 0:s.confirmed_at)||((r=o==null?void 0:o.user)===null||r===void 0?void 0:r.email_confirmed_at))&&(this._saveSession(o),this._notifyAllSubscribers("SIGNED_IN")),{data:o,user:o.user,session:o,error:null})}catch(o){return{data:null,user:null,session:null,error:o}}})}_handlePhoneSignIn(e,t){var i;return k(this,void 0,void 0,function*(){try{const{data:s,error:r}=yield this.api.signInWithPhone(e,t);return r||!s?{data:null,user:null,session:null,error:r}:(!((i=s==null?void 0:s.user)===null||i===void 0)&&i.phone_confirmed_at&&(this._saveSession(s),this._notifyAllSubscribers("SIGNED_IN")),{data:s,user:s.user,session:s,error:null})}catch(s){return{data:null,user:null,session:null,error:s}}})}_handleProviderSignIn(e,t={}){const i=this.api.getUrlForProvider(e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});try{return U()&&(window.location.href=i),{provider:e,url:i,data:null,session:null,user:null,error:null}}catch(s){return i?{provider:e,url:i,data:null,session:null,user:null,error:null}:{data:null,user:null,session:null,error:s}}}_handleOpenIDConnectSignIn({id_token:e,nonce:t,client_id:i,issuer:s,provider:r}){return k(this,void 0,void 0,function*(){if(e&&t&&(i&&s||r))try{const{data:o,error:a}=yield this.api.signInWithOpenIDConnect({id_token:e,nonce:t,client_id:i,issuer:s,provider:r});return a||!o?{user:null,session:null,error:a}:(this._saveSession(o),this._notifyAllSubscribers("SIGNED_IN"),{user:o.user,session:o,error:null})}catch(o){return{user:null,session:null,error:o}}throw new Error("You must provide a OpenID Connect provider with your id token and nonce.")})}_recoverSession(){try{const e=ir(this.localStorage,ae);if(!e)return null;const{currentSession:t,expiresAt:i}=e,s=Math.round(Date.now()/1e3);i>=s+be&&(t==null?void 0:t.user)&&(this._saveSession(t),this._notifyAllSubscribers("SIGNED_IN"))}catch(e){console.log("error",e)}}_recoverAndRefresh(){return k(this,void 0,void 0,function*(){try{const e=yield tr(this.localStorage,ae);if(!e)return null;const{currentSession:t,expiresAt:i}=e,s=Math.round(Date.now()/1e3);if(i<s+be)if(this.autoRefreshToken&&t.refresh_token){this.networkRetries++;const{error:r}=yield this._callRefreshToken(t.refresh_token);if(r){if(console.log(r.message),r.message===G.ERROR_MESSAGE&&this.networkRetries<G.MAX_RETRIES){this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),this.refreshTokenTimer=setTimeout(()=>this._recoverAndRefresh(),Math.pow(G.RETRY_INTERVAL,this.networkRetries)*100);return}yield this._removeSession()}this.networkRetries=0}else this._removeSession();else t?(this._saveSession(t),this._notifyAllSubscribers("SIGNED_IN")):(console.log("Current session is missing data."),this._removeSession())}catch(e){return console.error(e),null}})}_callRefreshToken(e){var t;return e===void 0&&(e=(t=this.currentSession)===null||t===void 0?void 0:t.refresh_token),k(this,void 0,void 0,function*(){try{if(!e)throw new Error("No current session.");const{data:i,error:s}=yield this.api.refreshAccessToken(e);if(s)throw s;if(!i)throw Error("Invalid session data.");return this._saveSession(i),this._notifyAllSubscribers("TOKEN_REFRESHED"),this._notifyAllSubscribers("SIGNED_IN"),{data:i,error:null}}catch(i){return{data:null,error:i}}})}_notifyAllSubscribers(e){this.stateChangeEmitters.forEach(t=>t.callback(e,this.currentSession))}_saveSession(e){this.currentSession=e,this.currentUser=e.user;const t=e.expires_at;if(t){const i=Math.round(Date.now()/1e3),s=t-i,r=s>be?be:.5;this._startAutoRefreshToken((s-r)*1e3)}this.persistSession&&e.expires_at&&this._persistSession(this.currentSession)}_persistSession(e){const t={currentSession:e,expiresAt:e.expires_at};er(this.localStorage,ae,t)}_removeSession(){return k(this,void 0,void 0,function*(){this.currentSession=null,this.currentUser=null,this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),sr(this.localStorage,ae)})}_startAutoRefreshToken(e){this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),!(e<=0||!this.autoRefreshToken)&&(this.refreshTokenTimer=setTimeout(()=>k(this,void 0,void 0,function*(){this.networkRetries++;const{error:t}=yield this._callRefreshToken();t||(this.networkRetries=0),(t==null?void 0:t.message)===G.ERROR_MESSAGE&&this.networkRetries<G.MAX_RETRIES&&this._startAutoRefreshToken(Math.pow(G.RETRY_INTERVAL,this.networkRetries)*100)}),e),typeof this.refreshTokenTimer.unref=="function"&&this.refreshTokenTimer.unref())}_listenForMultiTabEvents(){if(!this.multiTab||!U()||!(window!=null&&window.addEventListener))return!1;try{window==null||window.addEventListener("storage",e=>{var t;if(e.key===ae){const i=JSON.parse(String(e.newValue));!((t=i==null?void 0:i.currentSession)===null||t===void 0)&&t.access_token?(this._saveSession(i.currentSession),this._notifyAllSubscribers("SIGNED_IN")):(this._removeSession(),this._notifyAllSubscribers("SIGNED_OUT"))}})}catch(e){console.error("_listenForMultiTabEvents",e)}}_handleVisibilityChange(){if(!this.multiTab||!U()||!(window!=null&&window.addEventListener))return!1;try{window==null||window.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this._recoverAndRefresh()})}catch(e){console.error("_handleVisibilityChange",e)}}}class cr extends ar{constructor(e){super(e)}}var ii=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(c){try{h(i.next(c))}catch(u){o(u)}}function l(c){try{h(i.throw(c))}catch(u){o(u)}}function h(c){c.done?r(c.value):s(c.value).then(a,l)}h((i=i.apply(n,e||[])).next())})};class kt{constructor(e){Object.assign(this,e);let t;e.fetch?t=e.fetch:typeof fetch=="undefined"?t=(...i)=>ii(this,void 0,void 0,function*(){return yield(yield Le(()=>import("./browser-ponyfill.34bdb024.js").then(function(s){return s.b}),[])).fetch(...i)}):t=fetch,this.fetch=(...i)=>t(...i),this.shouldThrowOnError=e.shouldThrowOnError||!1,this.allowEmpty=e.allowEmpty||!1}throwOnError(e){return e==null&&(e=!0),this.shouldThrowOnError=e,this}then(e,t){typeof this.schema=="undefined"||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");let i=this.fetch(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(s=>ii(this,void 0,void 0,function*(){var r,o,a,l;let h=null,c=null,u=null,d=s.status,f=s.statusText;if(s.ok){const b=(r=this.headers.Prefer)===null||r===void 0?void 0:r.split(",").includes("return=minimal");if(this.method!=="HEAD"&&!b){const ze=yield s.text();ze&&(this.headers.Accept==="text/csv"?c=ze:c=JSON.parse(ze))}const _=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),oe=(a=s.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");_&&oe&&oe.length>1&&(u=parseInt(oe[1]))}else{const b=yield s.text();try{h=JSON.parse(b)}catch{h={message:b}}if(h&&this.allowEmpty&&((l=h==null?void 0:h.details)===null||l===void 0?void 0:l.includes("Results contain 0 rows"))&&(h=null,d=200,f="OK"),h&&this.shouldThrowOnError)throw h}return{error:h,data:c,count:u,status:d,statusText:f,body:c}}));return this.shouldThrowOnError||(i=i.catch(s=>({error:{message:`FetchError: ${s.message}`,details:"",hint:"",code:s.code||""},data:null,body:null,count:null,status:400,statusText:"Bad Request"}))),i.then(e,t)}}class lr extends kt{select(e="*"){let t=!1;const i=e.split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",i),this}order(e,{ascending:t=!0,nullsFirst:i=!1,foreignTable:s}={}){const r=typeof s=="undefined"?"order":`${s}.order`,o=this.url.searchParams.get(r);return this.url.searchParams.set(r,`${o?`${o},`:""}${e}.${t?"asc":"desc"}.${i?"nullsfirst":"nullslast"}`),this}limit(e,{foreignTable:t}={}){const i=typeof t=="undefined"?"limit":`${t}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,t,{foreignTable:i}={}){const s=typeof i=="undefined"?"offset":`${i}.offset`,r=typeof i=="undefined"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(r,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.headers.Accept="application/vnd.pgrst.object+json",this.allowEmpty=!0,this}csv(){return this.headers.Accept="text/csv",this}}class ee extends lr{constructor(){super(...arguments),this.cs=this.contains,this.cd=this.containedBy,this.sl=this.rangeLt,this.sr=this.rangeGt,this.nxl=this.rangeGte,this.nxr=this.rangeLte,this.adj=this.rangeAdjacent,this.ov=this.overlaps}not(e,t,i){return this.url.searchParams.append(`${e}`,`not.${t}.${i}`),this}or(e,{foreignTable:t}={}){const i=typeof t=="undefined"?"or":`${t}.or`;return this.url.searchParams.append(i,`(${e})`),this}eq(e,t){return this.url.searchParams.append(`${e}`,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(`${e}`,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(`${e}`,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(`${e}`,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(`${e}`,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(`${e}`,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(`${e}`,`like.${t}`),this}ilike(e,t){return this.url.searchParams.append(`${e}`,`ilike.${t}`),this}is(e,t){return this.url.searchParams.append(`${e}`,`is.${t}`),this}in(e,t){const i=t.map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(`${e}`,`in.(${i})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(`${e}`,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(`${e}`,`cs.{${t.join(",")}}`):this.url.searchParams.append(`${e}`,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(`${e}`,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(`${e}`,`cd.{${t.join(",")}}`):this.url.searchParams.append(`${e}`,`cd.${JSON.stringify(t)}`),this}rangeLt(e,t){return this.url.searchParams.append(`${e}`,`sl.${t}`),this}rangeGt(e,t){return this.url.searchParams.append(`${e}`,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(`${e}`,`nxl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(`${e}`,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(`${e}`,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(`${e}`,`ov.${t}`):this.url.searchParams.append(`${e}`,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:i,type:s=null}={}){let r="";s==="plain"?r="pl":s==="phrase"?r="ph":s==="websearch"&&(r="w");const o=i===void 0?"":`(${i})`;return this.url.searchParams.append(`${e}`,`${r}fts${o}.${t}`),this}fts(e,t,{config:i}={}){const s=typeof i=="undefined"?"":`(${i})`;return this.url.searchParams.append(`${e}`,`fts${s}.${t}`),this}plfts(e,t,{config:i}={}){const s=typeof i=="undefined"?"":`(${i})`;return this.url.searchParams.append(`${e}`,`plfts${s}.${t}`),this}phfts(e,t,{config:i}={}){const s=typeof i=="undefined"?"":`(${i})`;return this.url.searchParams.append(`${e}`,`phfts${s}.${t}`),this}wfts(e,t,{config:i}={}){const s=typeof i=="undefined"?"":`(${i})`;return this.url.searchParams.append(`${e}`,`wfts${s}.${t}`),this}filter(e,t,i){return this.url.searchParams.append(`${e}`,`${t}.${i}`),this}match(e){return Object.keys(e).forEach(t=>{this.url.searchParams.append(`${t}`,`eq.${e[t]}`)}),this}}class Ui extends kt{constructor(e,{headers:t={},schema:i,fetch:s,shouldThrowOnError:r}={}){super({fetch:s,shouldThrowOnError:r}),this.url=new URL(e),this.headers=Object.assign({},t),this.schema=i}select(e="*",{head:t=!1,count:i=null}={}){this.method="GET";let s=!1;const r=e.split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",r),i&&(this.headers.Prefer=`count=${i}`),t&&(this.method="HEAD"),new ee(this)}insert(e,{upsert:t=!1,onConflict:i,returning:s="representation",count:r=null}={}){this.method="POST";const o=[`return=${s}`];if(t&&o.push("resolution=merge-duplicates"),t&&i!==void 0&&this.url.searchParams.set("on_conflict",i),this.body=e,r&&o.push(`count=${r}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),Array.isArray(e)){const a=e.reduce((l,h)=>l.concat(Object.keys(h)),[]);if(a.length>0){const l=[...new Set(a)].map(h=>`"${h}"`);this.url.searchParams.set("columns",l.join(","))}}return new ee(this)}upsert(e,{onConflict:t,returning:i="representation",count:s=null,ignoreDuplicates:r=!1}={}){this.method="POST";const o=[`resolution=${r?"ignore":"merge"}-duplicates`,`return=${i}`];return t!==void 0&&this.url.searchParams.set("on_conflict",t),this.body=e,s&&o.push(`count=${s}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new ee(this)}update(e,{returning:t="representation",count:i=null}={}){this.method="PATCH";const s=[`return=${t}`];return this.body=e,i&&s.push(`count=${i}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new ee(this)}delete({returning:e="representation",count:t=null}={}){this.method="DELETE";const i=[`return=${e}`];return t&&i.push(`count=${t}`),this.headers.Prefer&&i.unshift(this.headers.Prefer),this.headers.Prefer=i.join(","),new ee(this)}}class hr extends kt{constructor(e,{headers:t={},schema:i,fetch:s,shouldThrowOnError:r}={}){super({fetch:s,shouldThrowOnError:r}),this.url=new URL(e),this.headers=Object.assign({},t),this.schema=i}rpc(e,{head:t=!1,count:i=null}={}){return t?(this.method="HEAD",e&&Object.entries(e).forEach(([s,r])=>{this.url.searchParams.append(s,r)})):(this.method="POST",this.body=e),i&&(this.headers.Prefer!==void 0?this.headers.Prefer+=`,count=${i}`:this.headers.Prefer=`count=${i}`),new ee(this)}}const ur="0.37.4",dr={"X-Client-Info":`postgrest-js/${ur}`};class fr{constructor(e,{headers:t={},schema:i,fetch:s,throwOnError:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},dr),t),this.schema=i,this.fetch=s,this.shouldThrowOnError=r}auth(e){return this.headers.Authorization=`Bearer ${e}`,this}from(e){const t=`${this.url}/${e}`;return new Ui(t,{headers:this.headers,schema:this.schema,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError})}rpc(e,t,{head:i=!1,count:s=null}={}){const r=`${this.url}/rpc/${e}`;return new hr(r,{headers:this.headers,schema:this.schema,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError}).rpc(t,{head:i,count:s})}}var m;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(m||(m={}));const si=(n,e,t={})=>{var i;const s=(i=t.skipTypes)!==null&&i!==void 0?i:[];return Object.keys(e).reduce((r,o)=>(r[o]=pr(o,n,e,s),r),{})},pr=(n,e,t,i)=>{const s=e.find(a=>a.name===n),r=s==null?void 0:s.type,o=t[n];return r&&!i.includes(r)?Mi(r,o):ot(o)},Mi=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return br(e,t)}switch(n){case m.bool:return vr(e);case m.float4:case m.float8:case m.int2:case m.int4:case m.int8:case m.numeric:case m.oid:return mr(e);case m.json:case m.jsonb:return gr(e);case m.timestamp:return yr(e);case m.abstime:case m.date:case m.daterange:case m.int4range:case m.int8range:case m.money:case m.reltime:case m.text:case m.time:case m.timestamptz:case m.timetz:case m.tsrange:case m.tstzrange:return ot(e);default:return ot(e)}},ot=n=>n,vr=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},mr=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},gr=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},br=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,i=n[t];if(n[0]==="{"&&i==="}"){let r;const o=n.slice(1,t);try{r=JSON.parse("["+o+"]")}catch{r=o?o.split(","):[]}return r.map(a=>Mi(e,a))}return n},yr=n=>typeof n=="string"?n.replace(" ","T"):n,wr="websocket",_r="Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",Sr=["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],Cr="Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",$r=["I\xF1aki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],Tr="1.0.34",Or={type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},kr="https://github.com/theturtle32/WebSocket-Node",Er={node:">=4.0.0"},jr={bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},xr={"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},Rr={verbose:!1},Ar={test:"tape test/unit/*.js",gulp:"gulp"},Pr="index",Ir={lib:"./lib"},Nr="lib/browser.js",Dr="Apache-2.0";var Br={name:wr,description:_r,keywords:Sr,author:Cr,contributors:$r,version:Tr,repository:Or,homepage:kr,engines:Er,dependencies:jr,devDependencies:xr,config:Rr,scripts:Ar,main:Pr,directories:Ir,browser:Nr,license:Dr},Lr=Br.version,J;if(typeof globalThis=="object")J=globalThis;else try{J=require("es5-ext/global")}catch{}finally{if(!J&&typeof window!="undefined"&&(J=window),!J)throw new Error("Could not determine global this")}var de=J.WebSocket||J.MozWebSocket,Ur=Lr;function zi(n,e){var t;return e?t=new de(n,e):t=new de(n),t}de&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(n){Object.defineProperty(zi,n,{get:function(){return de[n]}})});var Mr={w3cwebsocket:de?zi:null,version:Ur};const zr="1.7.2",Fr={"X-Client-Info":`realtime-js/${zr}`},Vr="1.0.0",Fi=1e4,Hr=1e3;var he;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(he||(he={}));var g;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(g||(g={}));var C;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(C||(C={}));var at;(function(n){n.websocket="websocket"})(at||(at={}));var W;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(W||(W={}));class Et{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class qr{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),i=new TextDecoder;return this._decodeBroadcast(e,t,i)}_decodeBroadcast(e,t,i){const s=t.getUint8(1),r=t.getUint8(2);let o=this.HEADER_LENGTH+2;const a=i.decode(e.slice(o,o+s));o=o+s;const l=i.decode(e.slice(o,o+r));o=o+r;const h=JSON.parse(i.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:h}}}class se{constructor(e,t,i={},s=Fi){this.channel=e,this.event=t,this.payload=i,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var i;return this._hasReceived(e)&&t((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel instanceof ct?this.channel.on(this.refEvent,e):this.channel.on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel.trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){!this.refEvent||(this.channel instanceof ct?this.channel.off(this.refEvent):this.channel.off(this.refEvent,{}))}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(i=>i.status===e).forEach(i=>i.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}class ct{constructor(e,t={},i){this.topic=e,this.params=t,this.socket=i,this.bindings=[],this.state=g.closed,this.joinedOnce=!1,this.pushBuffer=[],this.timeout=this.socket.timeout,this.joinPush=new se(this,C.join,this.params,this.timeout),this.rejoinTimer=new Et(()=>this.rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=g.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=g.closed,this.socket.remove(this)}),this.onError(s=>{this.isLeaving()||this.isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=g.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{!this.isJoining()||(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=g.errored,this.rejoinTimer.scheduleTimeout())}),this.on(C.reply,(s,r)=>{this.trigger(this.replyEventName(r),s)})}rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this.rejoin()}subscribe(e=this.timeout){if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";return this.joinedOnce=!0,this.rejoin(e),this.joinPush}onClose(e){this.on(C.close,e)}onError(e){this.on(C.error,t=>e(t))}on(e,t){this.bindings.push({event:e,callback:t})}off(e){this.bindings=this.bindings.filter(t=>t.event!==e)}canPush(){return this.socket.isConnected()&&this.isJoined()}push(e,t,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new se(this,e,t,i);return this.canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=g.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this.trigger(C.close,"leave",this.joinRef())};this.joinPush.destroy();let i=new se(this,C.leave,{},e);return i.receive("ok",()=>t()).receive("timeout",()=>t()),i.send(),this.canPush()||i.trigger("ok",{}),i}onMessage(e,t,i){return t}isMember(e){return this.topic===e}joinRef(){return this.joinPush.ref}rejoin(e=this.timeout){this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=g.joining,this.joinPush.resend(e))}trigger(e,t,i){let{close:s,error:r,leave:o,join:a}=C;if(i&&[s,r,o,a].indexOf(e)>=0&&i!==this.joinRef())return;let h=this.onMessage(e,t,i);if(t&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";this.bindings.filter(c=>c.event==="*"?e===(t==null?void 0:t.type):c.event===e).map(c=>c.callback(h,i))}replyEventName(e){return`chan_reply_${e}`}isClosed(){return this.state===g.closed}isErrored(){return this.state===g.errored}isJoined(){return this.state===g.joined}isJoining(){return this.state===g.joining}isLeaving(){return this.state===g.leaving}}class te{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel.on(i.state,{},s=>{const{onJoin:r,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel.joinRef(),this.state=te.syncState(this.state,s,r,o),this.pendingDiffs.forEach(l=>{this.state=te.syncDiff(this.state,l,r,o)}),this.pendingDiffs=[],a()}),this.channel.on(i.diff,{},s=>{const{onJoin:r,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=te.syncDiff(this.state,s,r,o),a())})}static syncState(e,t,i,s){const r=this.cloneDeep(e),o=this.transformState(t),a={},l={};return this.map(r,(h,c)=>{o[h]||(l[h]=c)}),this.map(o,(h,c)=>{const u=r[h];if(u){const d=c.map(_=>_.presence_id),f=u.map(_=>_.presence_id),v=c.filter(_=>f.indexOf(_.presence_id)<0),b=u.filter(_=>d.indexOf(_.presence_id)<0);v.length>0&&(a[h]=v),b.length>0&&(l[h]=b)}else a[h]=c}),this.syncDiff(r,{joins:a,leaves:l},i,s)}static syncDiff(e,t,i,s){const{joins:r,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return i||(i=()=>{}),s||(s=()=>{}),this.map(r,(a,l)=>{const h=e[a];if(e[a]=this.cloneDeep(l),h){const c=e[a].map(d=>d.presence_id),u=h.filter(d=>c.indexOf(d.presence_id)<0);e[a].unshift(...u)}i(a,h,l)}),this.map(o,(a,l)=>{let h=e[a];if(!h)return;const c=l.map(u=>u.presence_id);h=h.filter(u=>c.indexOf(u.presence_id)<0),e[a]=h,s(a,h,l),h.length===0&&delete e[a]}),e}static list(e,t){return t||(t=(i,s)=>s),this.map(e,(i,s)=>t(i,s))}static map(e,t){return Object.getOwnPropertyNames(e).map(i=>t(i,e[i]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,i)=>{const s=e[i];return"metas"in s?t[i]=s.metas.map(r=>(r.presence_id=r.phx_ref,delete r.phx_ref,delete r.phx_ref_prev,r)):t[i]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}list(e){return te.list(this.state,e)}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel.joinRef()}}class Re{constructor(e,t={},i){this.topic=e,this.params=t,this.socket=i,this.bindings=[],this.state=g.closed,this.joinedOnce=!1,this.pushBuffer=[],this.timeout=this.socket.timeout,this.joinPush=new se(this,C.join,this.params,this.timeout),this.rejoinTimer=new Et(()=>this.rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=g.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=g.closed,this.socket.remove(this)}),this.onError(s=>{this.isLeaving()||this.isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=g.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{!this.isJoining()||(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=g.errored,this.rejoinTimer.scheduleTimeout())}),this.on(C.reply,{},(s,r)=>{this.trigger(this.replyEventName(r),s)}),this.presence=new te(this)}list(){return this.presence.list()}rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this.rejoin()}subscribe(e=this.timeout){if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const t=this.bindings.reduce((i,s)=>{const{type:r}=s;return["phx_close","phx_error","phx_reply","presence_diff","presence_state"].includes(r)||(i[r]=s),i},{});return Object.keys(t).length&&this.updateJoinPayload({configs:t}),this.joinedOnce=!0,this.rejoin(e),this.joinPush}}onClose(e){this.on(C.close,{},e)}onError(e){this.on(C.error,{},t=>e(t))}on(e,t,i){this.bindings.push({type:e,filter:t!=null?t:{},callback:i!=null?i:()=>{}})}off(e,t){this.bindings=this.bindings.filter(i=>!(i.type===e&&Re.isEqual(i.filter,t)))}canPush(){return this.socket.isConnected()&&this.isJoined()}push(e,t,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new se(this,e,t,i);return this.canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=g.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this.trigger(C.close,"leave",this.joinRef())};this.joinPush.destroy();const i=new se(this,C.leave,{},e);return i.receive("ok",()=>t()).receive("timeout",()=>t()),i.send(),this.canPush()||i.trigger("ok",{}),i}onMessage(e,t,i){return t}isMember(e){return this.topic===e}joinRef(){return this.joinPush.ref}rejoin(e=this.timeout){this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=g.joining,this.joinPush.resend(e))}trigger(e,t,i){const{close:s,error:r,leave:o,join:a}=C;if(i&&[s,r,o,a].indexOf(e)>=0&&i!==this.joinRef())return;const h=this.onMessage(e,t,i);if(t&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";this.bindings.filter(c=>{var u,d;return(c==null?void 0:c.type)===e&&(((u=c==null?void 0:c.filter)===null||u===void 0?void 0:u.event)==="*"||((d=c==null?void 0:c.filter)===null||d===void 0?void 0:d.event)===(t==null?void 0:t.event))}).map(c=>c.callback(h,i))}send(e){const t=this.push(e.type,e);return new Promise((i,s)=>{t.receive("ok",()=>i("ok")),t.receive("timeout",()=>s("timeout"))})}replyEventName(e){return`chan_reply_${e}`}isClosed(){return this.state===g.closed}isErrored(){return this.state===g.errored}isJoined(){return this.state===g.joined}isJoining(){return this.state===g.joining}isLeaving(){return this.state===g.leaving}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(e[i]!==t[i])return!1;return!0}}var Gr=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(c){try{h(i.next(c))}catch(u){o(u)}}function l(c){try{h(i.throw(c))}catch(u){o(u)}}function h(c){c.done?r(c.value):s(c.value).then(a,l)}h((i=i.apply(n,e||[])).next())})},Jr=globalThis&&globalThis.__rest||function(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(t[i[s]]=n[i[s]]);return t};const Wr=()=>{};class Qr{constructor(e,t){this.accessToken=null,this.channels=[],this.endPoint="",this.headers=Fr,this.params={},this.timeout=Fi,this.transport=Mr.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.longpollerTimeout=2e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Wr,this.conn=null,this.sendBuffer=[],this.serializer=new qr,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.endPoint=`${e}/${at.websocket}`,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.transport&&(this.transport=t.transport),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs),t!=null&&t.longpollerTimeout&&(this.longpollerTimeout=t.longpollerTimeout),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(i,s)=>s(JSON.stringify(i)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Et(()=>Gr(this,void 0,void 0,function*(){yield this.disconnect(),this.connect()}),this.reconnectAfterMs)}connect(){this.conn||(this.conn=new this.transport(this.endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this.onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e)))}disconnect(e,t){return new Promise((i,s)=>{try{this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t||""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset()),i({error:null,data:!0})}catch(r){i({error:r,data:!1})}})}log(e,t,i){this.logger(e,t,i)}onOpen(e){this.stateChangeCallbacks.open.push(e)}onClose(e){this.stateChangeCallbacks.close.push(e)}onError(e){this.stateChangeCallbacks.error.push(e)}onMessage(e){this.stateChangeCallbacks.message.push(e)}connectionState(){switch(this.conn&&this.conn.readyState){case he.connecting:return W.Connecting;case he.open:return W.Open;case he.closing:return W.Closing;default:return W.Closed}}isConnected(){return this.connectionState()===W.Open}remove(e){this.channels=this.channels.filter(t=>t.joinRef()!==e.joinRef())}channel(e,t={}){var i;const{selfBroadcast:s}=t,r=Jr(t,["selfBroadcast"]);s&&(r.self_broadcast=s);const o=!((i=this.params)===null||i===void 0)&&i.vsndate?new Re(e,r,this):new ct(e,r,this);return o instanceof Re&&(o.presence.onJoin((a,l,h)=>{o.trigger("presence",{event:"JOIN",key:a,currentPresences:l,newPresences:h})}),o.presence.onLeave((a,l,h)=>{o.trigger("presence",{event:"LEAVE",key:a,currentPresences:l,leftPresences:h})}),o.presence.onSync(()=>{o.trigger("presence",{event:"SYNC"})})),this.channels.push(o),o}push(e){const{topic:t,event:i,payload:s,ref:r}=e;let o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${t} ${i} (${r})`,s),this.isConnected()?o():this.sendBuffer.push(o)}onConnMessage(e){this.decode(e.data,t=>{let{topic:i,event:s,payload:r,ref:o}=t;(o&&o===this.pendingHeartbeatRef||s===(r==null?void 0:r.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${r.status||""} ${i} ${s} ${o&&"("+o+")"||""}`,r),this.channels.filter(a=>a.isMember(i)).forEach(a=>a.trigger(s,r,o)),this.stateChangeCallbacks.message.forEach(a=>a(t))})}endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Vr}))}makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}setAuth(e){this.accessToken=e,this.channels.forEach(t=>{e&&t.updateJoinPayload({user_token:e}),t.joinedOnce&&t.isJoined()&&t.push(C.access_token,{access_token:e})})}leaveOpenTopic(e){let t=this.channels.find(i=>i.topic===e&&(i.isJoined()||i.isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_onConnOpen(){this.log("transport",`connected to ${this.endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e.trigger(C.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const i=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${i}${s}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(!!this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(Hr,"hearbeat timeout");return}this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class Kr{constructor(e,t,i,s){const r={},o=s==="*"?`realtime:${i}`:`realtime:${i}:${s}`,a=t.Authorization.split(" ")[1];a&&(r.user_token=a),this.subscription=e.channel(o,r)}getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=si(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=si(e.columns,e.old_record)),t}on(e,t){return this.subscription.on(e,i=>{let s={schema:i.schema,table:i.table,commit_timestamp:i.commit_timestamp,eventType:i.type,new:{},old:{},errors:i.errors};s=Object.assign(Object.assign({},s),this.getPayloadRecords(i)),t(s)}),this}subscribe(e=()=>{}){return this.subscription.onError(t=>e("SUBSCRIPTION_ERROR",t)),this.subscription.onClose(()=>e("CLOSED")),this.subscription.subscribe().receive("ok",()=>e("SUBSCRIBED")).receive("error",t=>e("SUBSCRIPTION_ERROR",t)).receive("timeout",()=>e("RETRYING_AFTER_TIMEOUT")),this.subscription}}class Yr extends Ui{constructor(e,{headers:t={},schema:i,realtime:s,table:r,fetch:o,shouldThrowOnError:a}){super(e,{headers:t,schema:i,fetch:o,shouldThrowOnError:a}),this._subscription=null,this._realtime=s,this._headers=t,this._schema=i,this._table=r}on(e,t){return this._realtime.isConnected()||this._realtime.connect(),this._subscription||(this._subscription=new Kr(this._realtime,this._headers,this._schema,this._table)),this._subscription.on(e,t)}}const Xr="0.0.0",Zr={"X-Client-Info":`storage-js/${Xr}`};var me=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(c){try{h(i.next(c))}catch(u){o(u)}}function l(c){try{h(i.throw(c))}catch(u){o(u)}}function h(c){c.done?r(c.value):s(c.value).then(a,l)}h((i=i.apply(n,e||[])).next())})};const eo=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),to=(n,e)=>{if(typeof n.json!="function")return e(n);n.json().then(t=>e({message:eo(t),status:(n==null?void 0:n.status)||500}))},io=(n,e,t,i)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(i),Object.assign(Object.assign({},s),t))};function Me(n,e,t,i,s,r){return me(this,void 0,void 0,function*(){return new Promise((o,a)=>{n(t,io(e,i,s,r)).then(l=>{if(!l.ok)throw l;return i!=null&&i.noResolveJson?o(l):l.json()}).then(l=>o(l)).catch(l=>to(l,a))})})}function lt(n,e,t,i){return me(this,void 0,void 0,function*(){return Me(n,"GET",e,t,i)})}function Q(n,e,t,i,s){return me(this,void 0,void 0,function*(){return Me(n,"POST",e,i,s,t)})}function so(n,e,t,i,s){return me(this,void 0,void 0,function*(){return Me(n,"PUT",e,i,s,t)})}function Vi(n,e,t,i,s){return me(this,void 0,void 0,function*(){return Me(n,"DELETE",e,i,s,t)})}var no=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(c){try{h(i.next(c))}catch(u){o(u)}}function l(c){try{h(i.throw(c))}catch(u){o(u)}}function h(c){c.done?r(c.value):s(c.value).then(a,l)}h((i=i.apply(n,e||[])).next())})};const Hi=n=>{let e;return n?e=n:typeof fetch=="undefined"?e=(...t)=>no(void 0,void 0,void 0,function*(){return yield(yield Le(()=>import("./browser-ponyfill.34bdb024.js").then(function(i){return i.b}),[])).fetch(...t)}):e=fetch,(...t)=>e(...t)};var X=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(c){try{h(i.next(c))}catch(u){o(u)}}function l(c){try{h(i.throw(c))}catch(u){o(u)}}function h(c){c.done?r(c.value):s(c.value).then(a,l)}h((i=i.apply(n,e||[])).next())})};class ro{constructor(e,t={},i){this.url=e,this.headers=Object.assign(Object.assign({},Zr),t),this.fetch=Hi(i)}listBuckets(){return X(this,void 0,void 0,function*(){try{return{data:yield lt(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){return{data:null,error:e}}})}getBucket(e){return X(this,void 0,void 0,function*(){try{return{data:yield lt(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}createBucket(e,t={public:!1}){return X(this,void 0,void 0,function*(){try{return{data:(yield Q(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public},{headers:this.headers})).name,error:null}}catch(i){return{data:null,error:i}}})}updateBucket(e,t){return X(this,void 0,void 0,function*(){try{return{data:yield so(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public},{headers:this.headers}),error:null}}catch(i){return{data:null,error:i}}})}emptyBucket(e){return X(this,void 0,void 0,function*(){try{return{data:yield Q(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}deleteBucket(e){return X(this,void 0,void 0,function*(){try{return{data:yield Vi(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}}var D=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(c){try{h(i.next(c))}catch(u){o(u)}}function l(c){try{h(i.throw(c))}catch(u){o(u)}}function h(c){c.done?r(c.value):s(c.value).then(a,l)}h((i=i.apply(n,e||[])).next())})};const oo={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ao={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class co{constructor(e,t={},i,s){this.url=e,this.headers=t,this.bucketId=i,this.fetch=Hi(s)}uploadOrUpdate(e,t,i,s){return D(this,void 0,void 0,function*(){try{let r;const o=Object.assign(Object.assign({},ao),s),a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});typeof Blob!="undefined"&&i instanceof Blob?(r=new FormData,r.append("cacheControl",o.cacheControl),r.append("",i)):typeof FormData!="undefined"&&i instanceof FormData?(r=i,r.append("cacheControl",o.cacheControl)):(r=i,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType);const l=this._removeEmptyFolders(t),h=this._getFinalPath(l),c=yield this.fetch(`${this.url}/object/${h}`,{method:e,body:r,headers:a});if(c.ok)return{data:{Key:h},error:null};{const u=yield c.json();return{data:null,error:u}}}catch(r){return{data:null,error:r}}})}upload(e,t,i){return D(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,i)})}update(e,t,i){return D(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,i)})}move(e,t){return D(this,void 0,void 0,function*(){try{return{data:yield Q(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers}),error:null}}catch(i){return{data:null,error:i}}})}copy(e,t){return D(this,void 0,void 0,function*(){try{return{data:yield Q(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers}),error:null}}catch(i){return{data:null,error:i}}})}createSignedUrl(e,t){return D(this,void 0,void 0,function*(){try{const i=this._getFinalPath(e);let s=yield Q(this.fetch,`${this.url}/object/sign/${i}`,{expiresIn:t},{headers:this.headers});const r=`${this.url}${s.signedURL}`;return s={signedURL:r},{data:s,error:null,signedURL:r}}catch(i){return{data:null,error:i,signedURL:null}}})}createSignedUrls(e,t){return D(this,void 0,void 0,function*(){try{return{data:(yield Q(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers})).map(s=>Object.assign(Object.assign({},s),{signedURL:s.signedURL?`${this.url}${s.signedURL}`:null})),error:null}}catch(i){return{data:null,error:i}}})}download(e){return D(this,void 0,void 0,function*(){try{const t=this._getFinalPath(e);return{data:yield(yield lt(this.fetch,`${this.url}/object/${t}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(t){return{data:null,error:t}}})}getPublicUrl(e){try{const t=this._getFinalPath(e),i=`${this.url}/object/public/${t}`;return{data:{publicURL:i},error:null,publicURL:i}}catch(t){return{data:null,error:t,publicURL:null}}}remove(e){return D(this,void 0,void 0,function*(){try{return{data:yield Vi(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){return{data:null,error:t}}})}list(e,t,i){return D(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},oo),t),{prefix:e||""});return{data:yield Q(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},i),error:null}}catch(s){return{data:null,error:s}}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}}class lo extends ro{constructor(e,t={},i){super(e,t,i)}from(e){return new co(this.url,this.headers,e,this.fetch)}}var ho=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(c){try{h(i.next(c))}catch(u){o(u)}}function l(c){try{h(i.throw(c))}catch(u){o(u)}}function h(c){c.done?r(c.value):s(c.value).then(a,l)}h((i=i.apply(n,e||[])).next())})};const uo=n=>{let e;return n?e=n:typeof fetch=="undefined"?e=(...t)=>ho(void 0,void 0,void 0,function*(){return yield(yield Le(()=>import("./browser-ponyfill.34bdb024.js").then(function(i){return i.b}),[])).fetch(...t)}):e=fetch,(...t)=>e(...t)};var fo=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(c){try{h(i.next(c))}catch(u){o(u)}}function l(c){try{h(i.throw(c))}catch(u){o(u)}}function h(c){c.done?r(c.value):s(c.value).then(a,l)}h((i=i.apply(n,e||[])).next())})};class po{constructor(e,{headers:t={},customFetch:i}={}){this.url=e,this.headers=t,this.fetch=uo(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t){return fo(this,void 0,void 0,function*(){try{const{headers:i,body:s}=t!=null?t:{},r=yield this.fetch(`${this.url}/${e}`,{method:"POST",headers:Object.assign({},this.headers,i),body:s}),o=r.headers.get("x-relay-error");if(o&&o==="true")return{data:null,error:new Error(yield r.text())};let a;const{responseType:l}=t!=null?t:{};return!l||l==="json"?a=yield r.json():l==="arrayBuffer"?a=yield r.arrayBuffer():l==="blob"?a=yield r.blob():a=yield r.text(),{data:a,error:null}}catch(i){return{data:null,error:i}}})}}var we=globalThis&&globalThis.__awaiter||function(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function a(c){try{h(i.next(c))}catch(u){o(u)}}function l(c){try{h(i.throw(c))}catch(u){o(u)}}function h(c){c.done?r(c.value):s(c.value).then(a,l)}h((i=i.apply(n,e||[])).next())})};const vo={schema:"public",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,multiTab:!0,headers:Li};class mo{constructor(e,t,i){if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const s=Bn(e),r=Object.assign(Object.assign({},vo),i);if(this.restUrl=`${s}/rest/v1`,this.realtimeUrl=`${s}/realtime/v1`.replace("http","ws"),this.authUrl=`${s}/auth/v1`,this.storageUrl=`${s}/storage/v1`,s.match(/(supabase\.co)|(supabase\.in)/)){const a=s.split(".");this.functionsUrl=`${a[0]}.functions.${a[1]}.${a[2]}`}else this.functionsUrl=`${s}/functions/v1`;this.schema=r.schema,this.multiTab=r.multiTab,this.fetch=r.fetch,this.headers=Object.assign(Object.assign({},Li),i==null?void 0:i.headers),this.shouldThrowOnError=r.shouldThrowOnError||!1,this.auth=this._initSupabaseAuthClient(r),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},r.realtime)),this._listenForAuthEvents(),this._listenForMultiTabEvents()}get functions(){return new po(this.functionsUrl,{headers:this._getAuthHeaders(),customFetch:this.fetch})}get storage(){return new lo(this.storageUrl,this._getAuthHeaders(),this.fetch)}from(e){const t=`${this.restUrl}/${e}`;return new Yr(t,{headers:this._getAuthHeaders(),schema:this.schema,realtime:this.realtime,table:e,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError})}rpc(e,t,{head:i=!1,count:s=null}={}){return this._initPostgRESTClient().rpc(e,t,{head:i,count:s})}channel(e,t){var i,s;const r=(s=(i=this.auth.session())===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:this.supabaseKey;return this.realtime.isConnected()||this.realtime.connect(),this.realtime.channel(e,Object.assign(Object.assign({},t),{user_token:r}))}removeAllSubscriptions(){return we(this,void 0,void 0,function*(){const e=this.getSubscriptions().slice(),t=e.map(s=>this.removeSubscription(s));return(yield Promise.all(t)).map(({error:s},r)=>({data:{subscription:e[r]},error:s}))})}removeChannel(e){return we(this,void 0,void 0,function*(){const{error:t}=yield this._closeSubscription(e),i=this.getSubscriptions(),s=i.filter(r=>r.isJoined()).length;return i.length===0&&(yield this.realtime.disconnect()),{data:{openChannels:s},error:t}})}removeSubscription(e){return we(this,void 0,void 0,function*(){const{error:t}=yield this._closeSubscription(e),i=this.getSubscriptions(),s=i.filter(r=>r.isJoined()).length;return i.length===0&&(yield this.realtime.disconnect()),{data:{openSubscriptions:s},error:t}})}_closeSubscription(e){return we(this,void 0,void 0,function*(){let t=null;if(!e.isClosed()){const{error:i}=yield this._unsubscribeSubscription(e);t=i}return this.realtime.remove(e),{error:t}})}_unsubscribeSubscription(e){return new Promise(t=>{e.unsubscribe().receive("ok",()=>t({error:null})).receive("error",i=>t({error:i})).receive("timeout",()=>t({error:new Error("timed out")}))})}getSubscriptions(){return this.realtime.channels}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:i,localStorage:s,headers:r,fetch:o,cookieOptions:a,multiTab:l}){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new cr({url:this.authUrl,headers:Object.assign(Object.assign({},r),h),autoRefreshToken:e,persistSession:t,detectSessionInUrl:i,localStorage:s,fetch:o,cookieOptions:a,multiTab:l})}_initRealtimeClient(e){return new Qr(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign(Object.assign({},e==null?void 0:e.params),{apikey:this.supabaseKey})}))}_initPostgRESTClient(){return new fr(this.restUrl,{headers:this._getAuthHeaders(),schema:this.schema,fetch:this.fetch,throwOnError:this.shouldThrowOnError})}_getAuthHeaders(){var e,t;const i=Object.assign({},this.headers),s=(t=(e=this.auth.session())===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey;return i.apikey=this.supabaseKey,i.Authorization=i.Authorization||`Bearer ${s}`,i}_listenForMultiTabEvents(){if(!this.multiTab||!Ln()||!(window!=null&&window.addEventListener))return null;try{return window==null?void 0:window.addEventListener("storage",e=>{var t,i,s;if(e.key===Dn){const r=JSON.parse(String(e.newValue)),o=(i=(t=r==null?void 0:r.currentSession)===null||t===void 0?void 0:t.access_token)!==null&&i!==void 0?i:void 0,a=(s=this.auth.session())===null||s===void 0?void 0:s.access_token;o?!a&&o?this._handleTokenChanged("SIGNED_IN",o,"STORAGE"):a!==o&&this._handleTokenChanged("TOKEN_REFRESHED",o,"STORAGE"):this._handleTokenChanged("SIGNED_OUT",o,"STORAGE")}})}catch(e){return console.error("_listenForMultiTabEvents",e),null}}_listenForAuthEvents(){let{data:e}=this.auth.onAuthStateChange((t,i)=>{this._handleTokenChanged(t,i==null?void 0:i.access_token,"CLIENT")});return e}_handleTokenChanged(e,t,i){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==t?(this.realtime.setAuth(t),i=="STORAGE"&&this.auth.setAuth(t),this.changedAccessToken=t):(e==="SIGNED_OUT"||e==="USER_DELETED")&&(this.realtime.setAuth(this.supabaseKey),i=="STORAGE"&&this.auth.signOut())}}const go=(n,e,t)=>new mo(n,e,t);var bo=Object.defineProperty,yo=Object.getOwnPropertyDescriptor,wo=(n,e,t,i)=>{for(var s=i>1?void 0:i?yo(e,t):e,r=n.length-1,o;r>=0;r--)(o=n[r])&&(s=(i?o(e,t,s):o(s))||s);return i&&s&&bo(e,t,s),s};let w=class extends z{constructor(){super(...arguments),this.routerConfiguration=new In}static setupNewStream(){var n;(n=w.editingReader)==null||n.cancel(),w.editing$=ht(e=>{w.controller=e}),w.editingReader=w.editing$.getReader()}connectedCallback(){w.setupNewStream(),w.supabase=go("https://cdllvkmnlpuuaxeuzegp.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNkbGx2a21ubHB1dWF4ZXV6ZWdwIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NTY4NjY4ODUsImV4cCI6MTk3MjQ0Mjg4NX0.2BliLwnyG1tUqOmXTnleFYzxmgZoGstr4WNZdiDsKSE"),super.connectedCallback()}};w.editing=!1;w=wo([A({name:"app-root",styles:re`
		:host {
			contain: content;
		}
	`,template:E`
		<fast-router :config=${n=>n.routerConfiguration}></fast-router>
	`})],w);
